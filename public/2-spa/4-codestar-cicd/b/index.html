<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.99.1" />
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>AWS Cloud9 Environment :: DevAx - Monoliths to Microservices - Microservices-SPA</title>

    
    <link href="/css/nucleus.css?1701078122" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1701078122" rel="stylesheet">
    <link href="/css/hybrid.css?1701078122" rel="stylesheet">
    <link href="/css/featherlight.min.css?1701078122" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1701078122" rel="stylesheet">
    <link href="/css/auto-complete.css?1701078122" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1701078122" rel="stylesheet">
    <link href="/css/theme.css?1701078122" rel="stylesheet">
    <link href="/css/hugo-theme.css?1701078122" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1701078122" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1701078122"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/2-spa/4-codestar-cicd/b/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1701078122"></script>
<script type="text/javascript" src="/js/auto-complete.js?1701078122"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1701078122"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-prerequisites/" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="/1-prerequisites/">
          <b>1. </b>Prerequisites
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/1-prerequisites/1-create-environment/" title="Create Environment" class="dd-item 
        
        
        
        ">
      <a href="/1-prerequisites/1-create-environment/">
          <b>1.1. </b>Create Environment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/1-prerequisites/1-create-environment/1-vpc/" title="VPC" class="dd-item 
        
        
        
        ">
      <a href="/1-prerequisites/1-create-environment/1-vpc/">
          <b>1.1.1. </b>VPC
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-prerequisites/1-create-environment/2-ec2/" title="EC2" class="dd-item 
        
        
        
        ">
      <a href="/1-prerequisites/1-create-environment/2-ec2/">
          <b>1.1.2. </b>EC2
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-prerequisites/1-create-environment/3-rds/" title="RDS" class="dd-item 
        
        
        
        ">
      <a href="/1-prerequisites/1-create-environment/3-rds/">
          <b>1.1.3. </b>RDS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-prerequisites/2-remote-env-config-cli/" title="Remote enviroment &amp; Configure the AWS CLI" class="dd-item 
        
        
        
        ">
      <a href="/1-prerequisites/2-remote-env-config-cli/">
          <b>1.2. </b>Remote enviroment &amp; Configure the AWS CLI
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/1-introduction/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/1-introduction/">
          <b>1. </b>Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-spa/" title="Single Page Application" class="dd-item 
        parent
        
        
        ">
      <a href="/2-spa/">
          <b>2. </b>Single Page Application
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-spa/1-prerequisites/" title="Pre-requisites" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/1-prerequisites/">
          <b>2.1. </b>Pre-requisites
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-spa/1-prerequisites/a/" title="Eclipse Environment" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/1-prerequisites/a/">
          <b>Option A. </b>Eclipse Environment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/1-prerequisites/b/" title="AWS Cloud9 Environment" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/1-prerequisites/b/">
          <b>Option B. </b>AWS Cloud9 Environment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/2-build-deploy/" title="Serverless Microservices" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/2-build-deploy/">
          <b>2.2. </b>Serverless Microservices
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/3-api-gateway/" title="Create and Expose the API" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/3-api-gateway/">
          <b>2.3. </b>Create and Expose the API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/4-codestar-cicd/" title="Deploy the API using CodeStar and CI/CD" class="dd-item 
        parent
        
        
        ">
      <a href="/2-spa/4-codestar-cicd/">
          <b>2.4. </b>Deploy the API using CodeStar and CI/CD
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-spa/4-codestar-cicd/a/" title="Eclipse Environment" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/4-codestar-cicd/a/">
          <b>Option A. </b>Eclipse Environment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/4-codestar-cicd/b/" title="AWS Cloud9 Environment" class="dd-item 
        parent
        active
        
        ">
      <a href="/2-spa/4-codestar-cicd/b/">
          <b>Option B. </b>AWS Cloud9 Environment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/5-setup-spa/" title="Setup the SPA Webpage" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/5-setup-spa/">
          <b>2.5. </b>Setup the SPA Webpage
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-spa/6-consume-api/" title="Consume the API" class="dd-item 
        
        
        
        ">
      <a href="/2-spa/6-consume-api/">
          <b>2.6. </b>Consume the API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-prepare/" title="Preparation" class="dd-item 
        
        
        
        ">
      <a href="/2-prepare/">
          <b>2. </b>Preparation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-prepare/2.1-createkeypair/" title="Create Key Pair" class="dd-item 
        
        
        
        ">
      <a href="/2-prepare/2.1-createkeypair/">
          <b>2.1. </b>Create Key Pair
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-prepare/2.2-createstack/" title="Create a CloudFormation stack" class="dd-item 
        
        
        
        ">
      <a href="/2-prepare/2.2-createstack/">
          <b>2.2. </b>Create a CloudFormation stack
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-prepare/2.3-connectvirtualmachine/" title="Connect to the Windows Instance" class="dd-item 
        
        
        
        ">
      <a href="/2-prepare/2.3-connectvirtualmachine/">
          <b>2.3. </b>Connect to the Windows Instance
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-aaa/" title="Configure AAA" class="dd-item 
        
        
        
        ">
      <a href="/3-aaa/">
          <b>3. </b>Configure AAA
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-aaa/1-cognito/" title="SPA Authentication" class="dd-item 
        
        
        
        ">
      <a href="/3-aaa/1-cognito/">
          <b>3.1. </b>SPA Authentication
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-aaa/2-microservice-authen/" title="Microservice Authentication" class="dd-item 
        
        
        
        ">
      <a href="/3-aaa/2-microservice-authen/">
          <b>3.2. </b>Microservice Authentication
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-aaa/3-deploy-test/" title="Deploy and Test" class="dd-item 
        
        
        
        ">
      <a href="/3-aaa/3-deploy-test/">
          <b>3.3. </b>Deploy and Test
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-aaa/4-signup-signin/" title="User Sign Up/Sign In" class="dd-item 
        
        
        
        ">
      <a href="/3-aaa/4-signup-signin/">
          <b>3.4. </b>User Sign Up/Sign In
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-create-single-page-app/" title="Creating A Single Page Application" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/">
          <b>3. </b>Creating A Single Page Application
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-create-single-page-app/3.1-create-dynamodb-table/" title="Create A DynamoDB Table" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/3.1-create-dynamodb-table/">
          <b>3.1. </b>Create A DynamoDB Table
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/" title="Manually Build And Deploy A Serverless Microservice" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/">
          <b>3.2. </b>Manually Build And Deploy A Serverless Microservice
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-single-page-app/3.3-create-api-with-api-gateway/" title="Create And Expose the API with Amazon API Gateway" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/3.3-create-api-with-api-gateway/">
          <b>3.3. </b>Create And Expose the API with Amazon API Gateway
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-single-page-app/3.4-deploy-api-with-codestar/" title="Deploy the api using code star and CI/CD" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/3.4-deploy-api-with-codestar/">
          <b>3.4. </b>Deploy the api using code star and CI/CD
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-single-page-app/3.5-setup-single-page-app-website/" title="Setup The Single Page Application Website" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/3.5-setup-single-page-app-website/">
          <b>3.5. </b>Setup The Single Page Application Website
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-single-page-app/3.6-build-api-consumer/" title="Build A Client To Consume The API" class="dd-item 
        
        
        
        ">
      <a href="/3-create-single-page-app/3.6-build-api-consumer/">
          <b>3.6. </b>Build A Client To Consume The API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-xray/" title="Application Performance" class="dd-item 
        
        
        
        ">
      <a href="/4-xray/">
          <b>4. </b>Application Performance
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-configure-aaa/" title="Configure Authentication, Authorization and Accounting (AAA)" class="dd-item 
        
        
        
        ">
      <a href="/4-configure-aaa/">
          <b>4. </b>Configure Authentication, Authorization and Accounting (AAA)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4-configure-aaa/4.1-add-authentication-with-cognito/" title="Add Authentication to the SPA using Amazon Cognito User Pools" class="dd-item 
        
        
        
        ">
      <a href="/4-configure-aaa/4.1-add-authentication-with-cognito/">
          <b>4.1. </b>Add Authentication to the SPA using Amazon Cognito User Pools
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-configure-aaa/4.2-setup-authentication/" title="Microservice Authentication" class="dd-item 
        
        
        
        ">
      <a href="/4-configure-aaa/4.2-setup-authentication/">
          <b>4.2. </b>Microservice Authentication
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-configure-aaa/4.3-deploy-and-test/" title="Deploy And Test" class="dd-item 
        
        
        
        ">
      <a href="/4-configure-aaa/4.3-deploy-and-test/">
          <b>4.3. </b>Deploy And Test
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-configure-aaa/4.4-add-new-user-signup_signin/" title="Add New User Sign Up and Sign In" class="dd-item 
        
        
        
        ">
      <a href="/4-configure-aaa/4.4-add-new-user-signup_signin/">
          <b>4.4. </b>Add New User Sign Up and Sign In
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-challenge/" title="Challenge" class="dd-item 
        
        
        
        ">
      <a href="/5-challenge/">
          <b>5. </b>Challenge
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-tracing-application-performance-with-xray/" title="Tracing Application Performance With AWS X-Ray" class="dd-item 
        
        
        
        ">
      <a href="/5-tracing-application-performance-with-xray/">
          <b>5. </b>Tracing Application Performance With AWS X-Ray
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-conclusion/" title="Conclusion" class="dd-item 
        
        
        
        ">
      <a href="/6-conclusion/">
          <b>6. </b>Conclusion
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-challenge/" title="Challenge" class="dd-item 
        
        
        
        ">
      <a href="/6-challenge/">
          <b>6. </b>Challenge
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-resources/" title="Reference resources" class="dd-item 
        
        
        
        ">
      <a href="/7-resources/">
          <b>7. </b>Reference resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-cleanup/" title="Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="/7-cleanup/">
          <b>7. </b>Clean up resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/660548818043427/"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/2-spa/4-codestar-cicd/b/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/2-spa/4-codestar-cicd/b/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7831159&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>27-11-2023</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Creating an Authenticated Single Page Application (SPA) </a> > <a href='/2-spa/'>Single Page Application</a> > <a href='/2-spa/4-codestar-cicd/'>Deploy the API using CodeStar and CI/CD</a> > AWS Cloud9 Environment
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              AWS Cloud9 Environment
            </h1>
          

        



	<p>The next microservice we need for our <strong>TravelBuddy serverless application</strong> is the <strong>FlightSpecials API</strong>. We have seen <strong>FlightSpecials</strong> before in this course, so it should be familiar to you. It functions the same way as the <strong>HotelSpecials API</strong> in that it must be deployed with VPC integration so it can connect to the MySQL database to query for data. Instead of manually packaging and deploying this microservice, we will use CodeStar to build out a full CI/CD pipeline for us, as we have done in previous labs. So, since you have created CI/CD pipelines using AWS CodeStar a few times now, we are not going to provide you with full step-by-step instructions. If you need help, ask a Lab Assistant how to complete the tasks required to create a new CodeStar project and deploy the <strong>FlightSpecials</strong> code over the sample application provided by CodeStar.</p>
<p><strong>Contents</strong></p>
<ul>
<li><a href="#create-a-cicd-pipeline-with-aws-codestar">Create a CI/CD pipeline with AWS CodeStar</a></li>
<li><a href="#update-placeholder-parameters-in-the-cloudformation-template">Update placeholder parameters in the CloudFormation template</a></li>
<li><a href="#update-the-target-aws-region-in-the-swaggeryml-api-definition-file">Update the target AWS region in the swagger.yml API definition file</a></li>
<li><a href="#create-codestar-project">Create CodeStar Project</a></li>
<li><a href="#aws-cloud9-setup-codecommit">AWS Cloud9 setup codecommit</a></li>
<li><a href="#check-changes-into-source-control-to-trigger-a-deploy">Check changes into source control to trigger a deploy</a></li>
<li><a href="#test-the-flightspecials-api">Test the FlightSpecials API</a></li>
</ul>
<h4 id="create-a-cicd-pipeline-with-aws-codestar">Create a CI/CD pipeline with AWS CodeStar</h4>
<ol>
<li>Create a new <strong>AWS CodeStar Web Service project</strong> targeting <strong>Java</strong> on <strong>AWS Lambda</strong>. Call the project <code>FlightSpecialsAPI</code>. If you need help with this task, see the <a href="https://docs.aws.amazon.com/codestar/latest/userguide/how-to-create-project.html">CodeStar documentation</a>.</li>
<li>Create the CodeStar project from your <strong>Cloud9 IDE</strong>. See the <a href="https://docs.aws.amazon.com/codestar/latest/userguide/setting-up-ide-ec.html">documentation</a>.  Remember to add the <code>git config helpers</code> setup as below:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd ~/environment
</span></span><span style="display:flex;"><span>aws codestar create-project --generate-cli-skeleton | tee template.yml
</span></span></code></pre></div><p>This will create a <code>template.yml</code> file with the base skeleton. It requires details the following details to be updated. You can think of this as an overlay to create your CodeStar project, which will use the toolchain and zip file for your creation of the codestar project</p>
<ul>
<li>S3 bucket name and key: This is the details for codestar deployment on where to grab the build for the pipeline.</li>
<li>Destination: This is the name of the codecommit repository or github repository, we are only using codecommit, but you can adapt this if you need to grab from your github repo.</li>
<li>Toolchain: this is a cloudformation template which sets up the required toolchain elements. It is the same as what has been done for you in eclipse, and will will create the following resources.
<ul>
<li>CodeCommit - s3bucket and policies to store the artifact</li>
<li>CodeCommit event - codecommit change occurs to action a new build</li>
<li>CodeBuild project - to build based off of the buildspec.yml</li>
<li>CodePipeline - project pipeline which will action all the required phases</li>
</ul>
</li>
</ul>
<ol start="3">
<li>Download and open the toolchain.yml file found here: <a href="https://workshops.devax.academy/monoliths-to-microservices/module6/files/toolchain.yml">toolchain.yml</a></li>
</ol>
<p>We need to change the details for the toolchain.yml file to point to the correct docker container to be used. The docker container has all the pre-built requirements based on different requirements. In this website look for the one which will suit our JAVA 1.8, maven requirements. <a href="https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-available.html">https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-available.html</a></p>
<p>In the <code>toolchain.yml</code> look for the current container which will look as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>  <span style="color:#f92672">CodeBuildProject</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">DependsOn</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">CodeBuildPolicy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Properties</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Artifacts</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Packaging</span>: <span style="color:#ae81ff">zip</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">codepipeline</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Cache</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">S3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Location</span>: !<span style="color:#ae81ff">Sub &#39;${S3Bucket}/codebuildcache&#39;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Description</span>: !<span style="color:#ae81ff">Sub &#34;AWS CodeStar created CodeBuild Project for ${ProjectId}&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Environment</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ComputeType</span>: <span style="color:#ae81ff">small</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># This environment variable informs AWS CodeBuild where it can retrieve your code artifact.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># You can specify any other environment variables your buildspec.yml is looking for.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">EnvironmentVariables</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">Name</span>: <span style="color:#ae81ff">S3_BUCKET</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">Value</span>: !<span style="color:#ae81ff">Ref &#39;S3Bucket&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Replace this Docker image if necessary: https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-available.html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Image</span>: <span style="color:#ae81ff">aws/codebuild/eb-nodejs-6.10.0-amazonlinux-64:4.0.0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">LINUX_CONTAINER</span>
</span></span></code></pre></div><ol start="4">
<li>Change the image to be the version you need for java.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws codebuild list-curated-environment-images
</span></span></code></pre></div><ol start="5">
<li>You could do this by also querying the <strong>json</strong> payload:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws codebuild list-curated-environment-images --query <span style="color:#e6db74">&#34;platforms[].languages[?language==&#39;JAVA&#39;].images&#34;</span>
</span></span></code></pre></div><ol start="6">
<li>Replace the latest one in the <strong>toolchain.yml</strong>: <code>Image:aws/codebuild/eb-java-8-amazonlinux-64:2.4.3-1.0.0</code></li>
</ol>
<p>Remember to change these as newer versions are released to make sure you are using the latest.</p>
<p>The other part to review is how the cache and the <code>buildspec</code> works. Notice the cache component:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>      <span style="color:#f92672">Cache</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">S3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Location</span>: !<span style="color:#ae81ff">Sub &#39;${S3Bucket}/codebuildcache&#39;</span>
</span></span></code></pre></div><p>This is setup to an S3 bucket, which is used in the setup for the <code>buildspec.yml</code> file - which is shown below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">cache</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">paths</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#39;/root/.m2/**/*&#39;</span>
</span></span></code></pre></div><ol start="7">
<li>You need to also provide the required service role to the template.yml you created. To get examples of this you can do the following:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws codestar create-project help
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># check the examples to get the service role : </span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;roleArn&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:role/service-role/aws-codestar-service-role&#34;</span>
</span></span></code></pre></div><ol start="8">
<li>Get the FlightSpecials.zip file and download it into your cloud9 environment, and unzip it. <a href="https://workshops.devax.academy/monoliths-to-microservices/module6/files/FlightSpecials.zip">FlightSpecials</a></li>
</ol>

<section class="attachments ">
	<label>
		<i class="fas fa-paperclip" aria-hidden="true"></i>
		FlightSpecials source code
	</label>
	
		
	
	<div class="attachments-files">
	
		
		
			
				<li>
					<a href="/2-spa/4-codestar-cicd/b/_index.files/FlightSpecials.zip" >
						FlightSpecials.zip
					</a>
					(18 ko)
				</li>
			
		
	
	<div>
	
</section>


<h4 id="update-placeholder-parameters-in-the-cloudformation-template">Update placeholder parameters in the CloudFormation template</h4>
<ol start="9">
<li>Edit the <code>FlightSpecials/template_cloud9.yml</code> and update the required parameters</li>
</ol>

<div class="notices note" ><p>If you are using eclipse you will need to have the CodeDeployRole as part of the parameters.</p>
</div>

<table>
<thead>
<tr>
<th style="text-align:center">Item to replace</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><!-- raw HTML omitted --></td>
<td style="text-align:center">First network subnet for the mySQL database</td>
</tr>
<tr>
<td style="text-align:center"><!-- raw HTML omitted --></td>
<td style="text-align:center">Second network subnet for the mySQL database</td>
</tr>
<tr>
<td style="text-align:center"><!-- raw HTML omitted --></td>
<td style="text-align:center">The security group for the mySQL database</td>
</tr>
<tr>
<td style="text-align:center"><!-- raw HTML omitted --></td>
<td style="text-align:center">The mySQL database endpoint</td>
</tr>
</tbody>
</table>
<p>When you’ve completed updating the values, the <strong>VPCConfig</strong> section will look similar to this (with different values):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">VpcConfig</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">SecurityGroupIds</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">sg-858e61e3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">SubnetIds</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">subnet-3c989d4a</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">subnet-a04255c4</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Environment</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Variables</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">JDBC_CONNECTION_STRING</span>: <span style="color:#ae81ff">jdbc:mysql://qlxx5jzrxxxby.cig0rzmdedgf.ap-northeast-1.rds.amazonaws.com:3306/travelbuddy?useSSL=false&amp;serverTimezone=UTC&amp;autoReconnect=true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">JDBC_UID</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">JDBC_PWD</span>: <span style="color:#ae81ff">labpassword</span>
</span></span></code></pre></div><h4 id="update-the-target-aws-region-in-the-swaggeryml-api-definition-file">Update the target AWS region in the swagger.yml API definition file</h4>
<p>The <code>swagger.yml</code> file provided in the zip bundle is the definition for the API that exposes the microservice via Amazon API Gateway. It needs to be updated with details of your lab AWS Account Id and target AWS Region before you can deploy your microservice.</p>
<ol start="10">
<li>In the <strong>Cloud9 IDE</strong>, locate the <code>swagger.yml</code> file and open it in the text editor</li>
<li>Search for the text <code>REPLACE_AWS_REGION</code> and replace it with the region you are using (for example, <code>ap-northeast-1</code>)</li>
<li>Search for the text <code>REPLACE_AWS_ACCOUNTID</code> and replace it with the your AWS Account Id. You can find your AWS Account Id in the lab dashboard.</li>
<li>Save the file.</li>
<li>When bundling the zip file to be used in codedeploy, you need to bundle from the source directory. To do this run the following:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd ~/environment/FlightSpecials
</span></span><span style="display:flex;"><span>zip -r ../FlightSpecials.zip *
</span></span></code></pre></div><ol start="15">
<li>Rezip the <code>FlightSpecials.zip</code> file with these updates.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd ~/environment
</span></span><span style="display:flex;"><span>rm FlightSpecials.zip
</span></span><span style="display:flex;"><span>cd FlightSpecials
</span></span><span style="display:flex;"><span>zip -r FlightSpecials.zip *
</span></span><span style="display:flex;"><span>adding: buildspec.yml <span style="color:#f92672">(</span>deflated 53%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: copy_files.sh <span style="color:#f92672">(</span>deflated 63%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: pom.xml <span style="color:#f92672">(</span>deflated 75%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/devlounge/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/devlounge/lambda/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/devlounge/lambda/test/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/devlounge/lambda/test/TestContext.java <span style="color:#f92672">(</span>deflated 76%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/devlounge/lambda/test/TestUtils.java <span style="color:#f92672">(</span>deflated 79%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/test/java/devlounge/lambda/test/LambdaFunctionHandlerTest.java <span style="color:#f92672">(</span>deflated 57%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/devlounge/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/devlounge/model/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/devlounge/model/FlightSpecial.java <span style="color:#f92672">(</span>deflated 73%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/devlounge/model/LambdaResult.java <span style="color:#f92672">(</span>deflated 62%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/devlounge/lambda/ <span style="color:#f92672">(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: src/main/java/devlounge/lambda/FlightSpecialsHandler.java <span style="color:#f92672">(</span>deflated 65%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: swagger.yml <span style="color:#f92672">(</span>deflated 68%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: template-configuration.json <span style="color:#f92672">(</span>deflated 18%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  adding: template.yml <span style="color:#f92672">(</span>deflated 65%<span style="color:#f92672">)</span>
</span></span></code></pre></div>
<div class="notices note" ><p>Note that the directory <strong>FlightSpecials</strong> is now omitted which is very important to only have the actual code there that is required.</p>
</div>


<div class="notices note" ><p>Note the directory structure here is <strong>REALLY</strong> important : <a href="https://docs.aws.amazon.com/codebuild/latest/userguide/getting-started-cli-upload-source-code.html">https://docs.aws.amazon.com/codebuild/latest/userguide/getting-started-cli-upload-source-code.html</a></p>
</div>

<h4 id="create-codestar-project">Create CodeStar Project</h4>
<ol start="16">
<li>Copy the code over to the <strong>FlightSpecials</strong>. Your lab bucket will look something like this <code>mod-9c10d0af24f74a4a-s3bucketlambdacode-vsuckr33vysr</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws s3 cp FlightSpecials.zip s3://&lt;Lambdabucket&gt;
</span></span></code></pre></div><ol start="17">
<li>Copy the <code>toolchain.yml</code> to the <strong>Lamdba bucket</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws s3 cp toolchain.yml s3://&lt;Lambdabucket&gt;
</span></span></code></pre></div><ol start="18">
<li>Create the codepipeline template for <strong>flightspecials</strong>, which will look like this:</li>
</ol>
<p>Change the <strong>XXX</strong> with your account details below for this to work.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;flightspecials&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;flightspecials&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;flight specials java8 example using ci/cd&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;sourceCode&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;source&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;s3&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;bucketName&#34;</span>: <span style="color:#e6db74">&#34;&lt;Lambdabucket&gt;&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;bucketKey&#34;</span>: <span style="color:#e6db74">&#34;FlightSpecials.zip&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;destination&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;codeCommit&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;flightspecials&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;toolchain&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;source&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;s3&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;bucketName&#34;</span>: <span style="color:#e6db74">&#34;&lt;Lambdabucket&gt;&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;bucketKey&#34;</span>: <span style="color:#e6db74">&#34;toolchain.yml&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;roleArn&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::XXX:role/service-role/aws-codestar-service-role&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;stackParameters&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;ProjectId&#34;</span>: <span style="color:#e6db74">&#34;flightspecials&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="19">
<li>Create the <strong>AWS Codestar project</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">aws</span> <span style="color:#960050;background-color:#1e0010">codestar</span> <span style="color:#960050;background-color:#1e0010">create-project</span> <span style="color:#960050;background-color:#1e0010">--cli-input-json</span> <span style="color:#960050;background-color:#1e0010">file:</span><span style="color:#75715e">//template.json
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;arn&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:codestar:ap-northeast-1:436753246579:project/flightspecials&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now check the cloudformation has completed, the codecommit has created a repo, and the first build has been kicked off.</p>
<p>If any of these fail, look at the errors. You will need to remove the created s3 buckets and recreate if there are any issues. If you are changing any code for <code>FlightSpecials.zip</code> remember to resend this to the lambda bucket, and not just on the filesystem.</p>
<p>To see if all worked : <code>aws codestar describe-project --id flightspecials</code></p>
<h4 id="aws-cloud9-setup-codecommit">AWS Cloud9 setup codecommit</h4>
<p>Once you have created this, you need to setup your required git repo for codecommit you configured previously.</p>
<ol start="20">
<li>Move the original zip file, as this was just for the first upload, then setup required helper class and clone your repository.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mv FlightSpecials FlightSpecials_orig
</span></span><span style="display:flex;"><span>git config --global credential.helper <span style="color:#e6db74">&#39;!aws codecommit credential-helper $@&#39;</span>
</span></span><span style="display:flex;"><span>git config --global credential.UseHttpPath true
</span></span><span style="display:flex;"><span>git clone https://git-codecommit.ap-northeast-1.amazonaws.com/v1/repos/flightspecials
</span></span><span style="display:flex;"><span>cd flightspecials
</span></span></code></pre></div><p><strong>Give CloudFormation permission to create an IAM role</strong></p>
<p>As part of our microservice setup, we will be assigning a new IAM Role to our Lambda function to allow it to perform various tasks. When <strong>CodeStar</strong> created our project, it created an IAM Role that gave CloudFormation just enough permissions to deploy the <strong>Hello World example</strong> service. These permissions are not enough for our more advanced requirements. So we need to adjust the policies assigned to the <strong>CloudFormation role</strong>, to extend those permissions.</p>
<ol start="21">
<li>Open the <strong>AWS IAM Console</strong> in the browser.</li>
<li>Click <strong>Roles</strong> on the navigation pane.</li>
<li>In the <strong>Filter</strong> box, type <code>CodeStarWorker-flightspecialsa-CloudFormation</code> to locate the correct <strong>IAM Role</strong>.</li>
</ol>

<div class="notices note" ><p>If you can&rsquo;t find the role, it may be too early - CodeStar may still be provisioning the pipeline and may not yet have created the role. Check the progress of the provisioning in the CodeStar dashboard.</p>
</div>

<ol start="24">
<li>Click on the role to open the details panel.</li>
<li>Click <strong>Attach Policy</strong>, in the <strong>Filter</strong> box, type <code>idevelop</code> to shortlist the available policies. Select the <code>idevelopCodeStarCloudFormationPolicy</code> policy shown in the list. This policy has been created for you by the lab setup process, and has the permissions assigned to it to allow CloudFormation to work on our behalf when creating the Lambda execution role.</li>
<li>Select the listed policy and click <strong>Attach Policy</strong></li>
</ol>
<h4 id="check-changes-into-source-control-to-trigger-a-deploy">Check changes into source control to trigger a deploy</h4>
<ol start="27">
<li>Now that you have completed updating files, you need to add the changed files to your <code>new-implementation</code> git branch and commit the files. You can use the commandline in your Cloud9 IDE:
<ul>
<li>Issue <code>git status</code> to review the changed code files</li>
<li>Issue <code>git add .</code> to add in the changed files</li>
<li>Issue <code>git commit -m &quot;Baseline implementation&quot;</code> to commit the changes and provide a message</li>
<li>Issue <code>git checkout master</code> to switch back to the master branch</li>
<li>Now merge the changes for your new implementation into the master branch by issuing <code>git merge new-implementation</code></li>
<li>Issue <code>git push</code> to push the changes to <strong>CodeCommit</strong>.</li>
</ul>
</li>
</ol>
<p>It will take a few moments to push the code and commence the deployment. Checking in the source code and templates will trigger the pipeline to build and deploy the new implementation. AWS CodePipeline will now use CloudFormation to deploy the following resources:</p>
<p>While you have some time, spend a few minutes to explore the <code>buildspec.yml</code>, <code>swagger.yml</code> and <code>template.yml</code> files which define the Amazon API Gateway, AWS Lambda function and the build/deployment process through AWS CodeBuild. You will notice that the <code>builspec.yml</code> file uses the same AWS CLI command to package the deployment that you used when you manually packaged the <strong>HotelSpecials API</strong> earlier</p>

<div class="notices warning" ><p>Do not execute these commands below, they are here as a reference!</p>
</div>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn package shade:shade
</span></span><span style="display:flex;"><span>aws cloudformation package --template template.yml --s3-bucket $S3_BUCKET --output-template template-export.yml
</span></span></code></pre></div><p>The <code>template.yml</code> file uses the <strong>Serverless Application Model (SAM)</strong> transform to define the REST API, as opposed to how we approached this in the <strong>HotelSpecials API</strong> example. In <strong>HotelSpecials</strong>, the <strong>CloudFormation template</strong> used canonical CloudFormation to define the REST API so that it could be explicit about the API definition and include the <code>swagger</code> definition inline. The <strong>FlightSpecials</strong> example uses a more declarative approach and left the details to SAM. You are free to mix CloudFormation and SAM in the same template, as you can see from these examples.</p>

<div class="notices note" ><p>Note that the <code>$S3_BUCKET</code> environment variable is automatically replaced by CodeBuild when the build step is performed, and replaced by the S3 Bucket that CodeStar provisioned when it set up the project.</p>
</div>

<h4 id="test-the-flightspecials-api">Test the FlightSpecials API</h4>
<p>You can check the <strong>status</strong> of the deployment of the code change through the pipeline back on the CodeStar project dashboard. Once the deployment has completed through the CI/CD pipeline, you are ready to test the API.</p>
<ol start="28">
<li>Open the <strong>API Gateway console</strong> in the browser and under <strong>APIs</strong>, click the <code>iDevelop - Flight Specials API</code> link to reveal the resources for the API.</li>
<li>Click on the <strong>Stages</strong> link beneath the <strong>iDevelop - Flight Specials API</strong>.</li>
<li>Expand the <strong>prod</strong> root element in the <strong>Stages</strong> list to reveal the hierarchy.</li>
<li>Click on the <strong>GET</strong> method</li>
<li>Click on the <strong>Invoke URL</strong> value in the <strong>prod - GET - /flightspecials</strong> panel. After a moment while the Lambda function is initialised, you should see the JSON result of querying the mySQL database from the Lambda function. For example:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;succeeded&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;errorCode&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;data&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;header&#34;</span>: <span style="color:#e6db74">&#34;London to Prague&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;body&#34;</span>: <span style="color:#e6db74">&#34;Jewel of the East&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;cost&#34;</span>: <span style="color:#ae81ff">93</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;expiryDate&#34;</span>: <span style="color:#ae81ff">1504072439813</span>
</span></span><span style="display:flex;"><span>        }, 
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;header&#34;</span>: <span style="color:#e6db74">&#34;Paris to London&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;body&#34;</span>: <span style="color:#e6db74">&#34;Weekend getaway!&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;cost&#34;</span>: <span style="color:#ae81ff">182</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;expiryDate&#34;</span>: <span style="color:#ae81ff">1504074888702</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If you see a JSON payload with no errors, you have successfully deployed an API and supporting Lambda function that queries the mySQL database. Notice how much quicker and easier that was to deploy without any manual intervention, and you didn&rsquo;t even have to interact with the AWS CLI or Console? Everything was driven by the source control check-in process.</p>
<p>You are now ready to integrate these APIs with the <strong>TravelBuddy</strong> web site.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/2-spa/4-codestar-cicd/a/" title="Eclipse Environment"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/2-spa/5-setup-spa/" title="Setup the SPA Webpage" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1701078122"></script>
    <script src="/js/perfect-scrollbar.min.js?1701078122"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1701078122"></script>
    <script src="/js/jquery.sticky.js?1701078122"></script>
    <script src="/js/featherlight.min.js?1701078122"></script>
    <script src="/js/highlight.pack.js?1701078122"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1701078122"></script>
    <script src="/js/learn.js?1701078122"></script>
    <script src="/js/hugo-learn.js?1701078122"></script>

    <link href="/mermaid/mermaid.css?1701078122" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1701078122"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
