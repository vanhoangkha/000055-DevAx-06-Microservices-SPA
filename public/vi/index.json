[
{
	"uri": "/vi/",
	"title": "Creating an Authenticated Single Page Application (SPA)",
	"tags": [],
	"description": "",
	"content": "Creating an Authenticated Single Page Application (SPA) In this lab we will iterate on our TravelBuddy monolithic implementation, and move it to a serverless/serviceful architecture, with microservices. In previous Labs, we have looked at various serverless concepts - for example, AWS Lambda and Amazon API Gateway - but in this lab, we will rethink our monolith, move to a completely serverless model and incorporate authentication and authorisation using Amazon Cognito.\nYou will take various approaches when deploying the Lambda functions that make up the microservices, from manual deployment to automated CI/CD deployment, to ensure you have a good understanding of each of parts of the architecture, and how infrastructure automation simplifies and streamlines deployment.\nThe overall architecture you will build is as follows:\nThe source code for the Single-Page Web Application will be provided for you, but you will need to configure the details that relate to your AWS account and host the SPA in Amazon S3.\nYou will make use of the following services:\nAmazon Cognito Amazon Cognito lets you easily add user sign-up and sign-in to your mobile and web apps. With Amazon Cognito, you also have the options to authenticate users through social identity providers such as Facebook, Twitter, or Amazon, with SAML identity solutions, or by using your own identity system.\nClick here for more information about Amazon Cognito\nAmazon API Gateway Amazon API Gateway is an AWS service that enables developers to create, publish, maintain, monitor, and secure APIs at any scale. You can create APIs that access AWS or other web services, as well as data stored in the AWS Cloud. API Gateway can be considered a backplane in the cloud to connect AWS services and other public or private web sites. It provides consistent RESTful application programming interfaces (APIs) for mobile and web applications to access AWS services.\nClick here for more information about Amazon API Gateway\nTopics Covered By the end of this lab, you will be able to:\n Understand how you can take a monolithic application and distill it down into a Single Page Web Application hosted on Amazon S3, with supporting business logic provided by Amazon API Gateway and AWS Lambda Use the AWS Console to create and configure an Amazon Cognito User Pool and Identity Pool for use in your serverless application Manually deploy a Lambda function using the AWS CLI Manually deploy a Lambda function using the AWS CLI CloudFormation tool Manually configure an API in Amazon API Gateway Automate the full deployment of an API using CodeStar Generate SDKs from Amazon API Gateway  Technical Knowledge Prerequisites To successfully complete this lab, you should be familiar with basic navigation of the AWS Management Console and have intermediate experience using the Eclipse IDE and the Java Programming language.\nNội dung  Prerequisite Tạo một Ứng dụng Đơn trang Cấu hình Authentication, Authorization và Accounting (AAA) Theo dõi Hiệu năng Ứng dụng với AWS X-Ray Bài tập nâng cao Kết luận Tài liệu tham khảo  "
},
{
	"uri": "/vi/1-prerequisites/",
	"title": "Các bước chuẩn bị",
	"tags": [],
	"description": "",
	"content": "Welcome to the first module in this workshop! This module involves getting access to a developer environment that we’ve provisioned for you. The developer environment contains all the software and network access required to get you up and running with the labs in record time.\nWe’ve chosen to do this as the main aim for this workshop is learning the content in each module, not setting up your local machines. It also provides a consistent environment between you and your fellow colleagues to eliminate the weird “works on my machine” behavior.\nIf you were planning on running this lab on your own machine, you’ll have to adapt the instructions accordingly. Make sure to manually install the software listed in the Development Environment section below.\nContents\n Topics Covered Development Environment  Topics Covered By the end of this lab, you will be able to:\nConnect to a running windows instance\nDevelopment Environment A fully fledged development environment has already been created for you with the following resources installed:\n Java 8 JDK Apache Maven Eclipse IDE for Java EE Developers Tomcat 9 AWS Toolkit for eclipse AWS CLI Elastic Beanstalk CLI  "
},
{
	"uri": "/vi/2-spa/1-prerequisites/",
	"title": "Các bước chuẩn bị",
	"tags": [],
	"description": "",
	"content": "Trong bài thực hành, bạn có sự lựa chọn việc thực hiện trên môi trường Windows và Eclipse hoặc sử dụng môi trường phát triển trên Cloud sử udngj AWS Cloud9. AWS Cloud9 là một môi trường phát triển tích hợp (IDE) cho phép bạn viết, chạy và debug code của bạn trên trình duyệt.\nNếu chưa sử dụng Cloud9 trước đó, đây là một cơ hội tốt để bạn sử nghiệm sử dụng môi trường IDE trên cloud! Bằng bất kì cách nào bạn chọn, bạn đều có thể thực hiện toàn bộ bài thực hành này.\n\rNội dung\n Lựa chọn A: Sử dụng Eclipse Lựa chọn B: Sử dụng AWS Cloud9  "
},
{
	"uri": "/vi/2-spa/1-prerequisites/a/",
	"title": "Dùng Eclipse",
	"tags": [],
	"description": "",
	"content": "Trong bài thực hành, bạn sẽ kết nối tới \u0026ldquo;Máy ảo Windows\u0026rdquo;. Bạn sẽ sử dụng máy ảo Windows được tạo từ Cloud Formation để thực hiện bài thực hành.\nNội dung\n Cài đặt \u0026amp; Cấu hình các bước ban đầu - Sử dụng Eclipse Thiết lập DynamoDB  Cài đặt \u0026amp; Cấu hình các bước ban đầu - Sử dụng Eclipse Trong bài thực hành, bạn sẽ kết nối tới Máy chủ Windows. Bạn sẽ sử dụng máy ảo Windows được tạo từ Cloud Formation để thực hiện bài thực hành.\n Một Máy chủ Windows đã được thiết lập cho bạn. Để truy cập vào được instance này, hãy thực hiện theo các bước trong Phần 1.2. Môi trường Remote và Thiết lập AWS CLI, sau đó tiếp tục thực hiện bài thực hành:  Thiết lập DynamoDB Chúng ta sẽ cần thực hiện đưa dữ liệu vào trong DynamoDB table, các thông tin này sẽ được sử dụng xuyên suốt bài thực hành. Dữ liệu này sẽ được sử dụng để tính toán các chuyến đi giữa các thành phố với nhau.\nBạn chỉ thực hiện bước này sau khi hoàn thành việc thiết lập Máy chủ Windows.\nTải tập tin sau về môi trường máy chủ Windows của bạn: populate_tripsector.sh Thực thi câu lệnh sau trong Eclipse trên máy chủ Windows. Bạn sẽ cần sử dụng cửa sổ lệnh git bash đã được cài đặt.  bash populate_tripsector.sh \u0026lt;AWS_REGION\u0026gt;\rMở dịch vụ DynamoDB trong AWS Console và kiểm tra table TravelBuddyTripSectors. Hãy chắc chắn rằng đã có 50 bản ghi được thêm vào trong table.  "
},
{
	"uri": "/vi/2-spa/4-codestar-cicd/a/",
	"title": "Dùng Eclipse",
	"tags": [],
	"description": "",
	"content": "Dịch vụ vi mô tiếp theo mà chúng ta cần cho ứng dụng không máy chủ TravelBuddy của chúng ta là FlightSpecials API. Chúng ta đã xem FlightSpecials trước đây trong các phần trước, vì vậy nó sẽ quen thuộc với bạn. Nó hoạt động giống như HotelSpecials API ở chỗ nó phải được triển khai tích hợp với VPC để nó có thể kết nối với cơ sở dữ liệu MySQL để truy vấn dữ liệu. Thay vì đóng gói và triển khai microservice này theo cách thủ công, chúng ta sẽ sử dụng CodeStar để xây dựng CI/CD pipeline đầy đủ cho chúng ta, như chúng ta đã làm trong các bài thực hành trước đây. Vì vậy, do bạn đã tạo CI/CD pipeline bằng AWS CodeStar một vài lần, nên chúng ta sẽ không cung cấp cho bạn hướng dẫn từng bước đầy đủ. Nếu bạn cần trợ giúp, hãy tham khảo các tài liệu về cách hoàn thành các tác vụ cần thiết để tạo một dự án CodeStar mới và triển khai mã FlightSpecials trên ứng dụng mẫu do CodeStar cung cấp.\nNội dung\n Tạo một CI/CD pipeline với AWS CodeStar Cập nhật các thông số trong CloudFormation template Cập nhật AWS region trong tập tin định nghĩa API swagger.yml Kiểm tra các thay đổi đưa vào quản lý mã nguồn để kích hoạt quá trình triển khai Kiểm thử API FlightSpecials  Tạo một CI/CD pipeline với AWS CodeStar  Tạo một project AWS CodeStar Web Service mới với mục tiêu là Java trên AWS Lambda. Đặt tên cho project là FlightSpecialsAPI.\nBạn có thể tham khảo thêm tại Tài liệu CodeStar. Thêm project CodeStar vào Eclipse IDE.\nXem thêm tài liệu nếu bạn cần tham khảo.\nHãy nhớ rằng thông tin đăng nhập Git của bạn cho bài thực hành này được cung cấp trong phần output của CloudFormation template.\nNếu sử dụng Cloud9, hãy nhớ thêm git config helpers. Tải về mã nguồn của FlightSpecials và giải nén trong môi trường làm việc của bạn  \r\rMã nguồn FlightSpecials\r\r\rFlightSpecials.zip\r\r(18 ko)\r\r\r\rTạo một nhánh mới trong git cho việc triển khai mà bạn sắp thực hiện. Đặt tên nhánh mới là new-implementation. Ghi đè phần triển khai do CodeStar cung cấp bằng nội dung của tập tin ZIP mà bạn vừa giải nén. Chúng ta có script copy_files.sh trong tập tin FlightSpecials.zip mà bạn có thể dùng như trong các bài thực hành trước. Để sử dụng, thực thi lệnh sau sau khi thay đường dẫn path/to/your/working/folder. Ví dụ:  copy_files.sh /path/to/your/working/folder\rĐừng quên sử dụng Maven | Update Project của IDE Eclipse để cập nhật lại project sau khi có thay đổi mã nguồn.\nCấp quyền cho CloudFormation để tạo IAM role\nLà một phần của việc thiết lập microservice của chúng ta, chúng ta sẽ chỉ định IAM Role mới cho hàm Lambda của chúng ta để cho phép nó thực hiện các tác vụ khác nhau. Khi CodeStar tạo project, nó đã tạo một IAM Role cấp cho CloudFormation vừa đủ quyền để triển khai dịch vụ Hello World example. Các quyền này không đủ cho các yêu cầu nâng cao hơn của chúng ta. Vì vậy, chúng ta cần điều chỉnh các chính sách được chỉ định cho CloudFormation role, để mở rộng các quyền đó.\nTruy cập AWS IAM Console trên trình duyệt. Chọn Roles ở thanh điều hướng bên trái. Trong ô Filter nhập CodeStarWorker-flightspecialsa-CloudFormation để tìm đúng IAM Role.  Nếu bạn không thể tìm thấy role, có thể do còn quá sớm - CodeStar vẫn đang trong quy trình cấp phát và có thể chưa tạo role. Kiểm tra tiến trình cung cấp trong CodeStar dashboard.\n\rChọn vào role để mở bảng thông tin chi tiết. Chọn Attach Policy, trong ô Filter nhập idevelop để chọn các chính sách có sẵn. Chọn chính sách idevelopCodeStarCloudFormationPolicy trong danh sách. Chính sách này đã được tạo cho bạn bởi quá trình thiết lập bài thực hành và có các quyền được chỉ định cho nó để cho phép CloudFormation làm việc thay mặt chúng ta khi tạo role thực thi Lambda. Chọn chính sách được liệt kê và nhấp vào Attach Policy  Cập nhật các thông số trong CloudFormation template CloudFormation template template.yml được cung cấp là một phần của FlightSpecials.zip. Tập tin có một số vị trí mà bạn cần cập nhật để khớp với các giá trị từ tài khoản lab của bạn trước khi bạn có thể triển khai cập nhật. Bao gồm Subnet Ids, Security Group Ids và RDS Instance Endpoint là các tài nguyên duy nhất của tài khoản của bạn.  Trong Eclipse IDE, mở tập tin template.yml và tìm kiếm từng mục trong bảng dưới đây trong cột Item to replace, và thay thế chúng bằng các giá trị được tìm thấy trong Cloudformation Outputs:\n   Mục để thay thế Mô tả      Mạng con đầu tiên cho cơ sở dữ liệu MySQL    Mạng con thứ hai cho cơ sở dữ liệu MySQL    Security group cho cơ sở dữ liệu MySQL    MySQL database endpoint    Khi bạn đã cập nhật xong các giá trị, mục VPCConfig sẽ trông tương tự như sau (với các giá trị khác nhau):  VpcConfig:\rSecurityGroupIds:\r- sg-858e61e3\rSubnetIds:\r- subnet-3c989d4a\r- subnet-a04255c4\rEnvironment:\rVariables:\rJDBC_CONNECTION_STRING: jdbc:mysql://qlxx5jzrxxxby.cig0rzmdedgf.ap-northeast-1.rds.amazonaws.com:3306/travelbuddy?useSSL=false\u0026amp;serverTimezone=UTC\u0026amp;autoReconnect=true\rJDBC_UID: root\rJDBC_PWD: labpassword\rCập nhật AWS region trong tập tin định nghĩa API swagger.yml Tập tin swagger.yml được cung cấp trong gói zip là định nghĩa cho API sẽ cung cấp microservice thông qua Amazon API Gateway. Nó cần được cập nhật thông tin chi tiết về AWS Account ID trong bài thực hành của bạn và Region AWS mục tiêu trước khi bạn có thể triển khai dịch vụ vi mô của mình.\nTrong Eclipse IDE, tìm tập tin swagger.yml và mở ra trong trình soạn thảo văn bản. Tìm kiếm REPLACE_AWS_REGION và thay thế nó bằng khu vực bạn đang sử dụng(VD: ap-northeast-1) Tìm kiếm REPLACE_AWS_ACCOUNTID và thay thế nó bằng AWS Account Id. Bạn có thể tìm thấy AWS Account ID của mình trong trang tổng quan của bài thực hành. Lưu tập tin.  Kiểm tra các thay đổi đưa vào quản lý mã nguồn để kích hoạt quá trình triển khai Bây giờ bạn đã hoàn tất cập nhật tập tin, bạn cần thêm các tập tin đã thay đổi vào new-implementation git branch và xác nhận các thay đổi. Bạn có thể dùng Eclipse IDE hoặc CLI. Trong ví dụ này, chúng ta sẽ sử dụng Eclipse IDE, nhưng lưu ý đối với lần đẩy cuối cùng, bạn sẽ cần sử dụng IDE Eclipse vì nó được định cấu hình bằng thông tin đăng nhập Git của bạn, trong khi cửa sổ lệnh thì không:  Thực thi git status để kiểm tra lại các thay đổi về code. Thực thi git add . để thêm vào các tập tin đã thay đổi. Thực thi git commit -m \u0026quot;Baseline implementation\u0026quot; xác nhận các thay đổi và cung cấp một thông báo Thực thi git checkout master để chuyển trở lại master branch Bây giờ hợp nhất các thay đổi cho triển khai mới của bạn vào nhánh chính bằng cách phát hành git merge new-implementation Đẩy các thay đổi lên CodeCommit sử dụng Eclipse bằng cách nhấp chuột phải vào vị trí root và chọn Team | Push to Origin\u0026hellip;    Bạn cần thực hiện đẩy từ Eclipse vì thông tin xác thực git được nhúng trong môi trường Eclipse. Bạn cũng có thể định cấu hình môi trường dòng lệnh bằng thông tin đăng nhập git nhưng điều đó nằm ngoài phạm vi của phòng thí nghiệm này.\nSẽ mất một vài phút để đẩy mã và bắt đầu triển khai. Kiểm tra mã nguồn và các template sẽ kích hoạt quá trình xây dựng và triển khai thực hiện mới. AWS CodePipeline hiện sẽ sử dụng CloudFormation để triển khai các tài nguyên sau:\n- Hàm Lambda được triển khai bởi mã Java mà bạn đã kiểm tra trong CodeCommit\r- IAM role cho hàm Lambda\r- Cấu hình API Gateway cho API\r Trong khi bạn có chút thời gian, hãy dành vài phút để khám phá buildspec.yml, swagger.yml và template.yml các tệp xác định Amazon API Gateway, hàm AWS Lambda và quá trình build/deploy thông qua AWS CodeBuild. Bạn sẽ nhận thấy rằng tập tin builspec.yml sử dụng cùng một lệnh AWS CLI để đóng gói triển khai mà bạn đã sử dụng khi đóng gói HotelSpecials API theo cách thủ công trước đó\nĐừng thực thi lệnh bên dưới, chúng chỉ để bạn tham khảo thêm.\n\rmvn package shade:shade\raws cloudformation package --template template.yml --s3-bucket $S3_BUCKET --output-template template-export.yml\rTập tin template.yml sử dụng Serverless Application Model (SAM) chuyển đổi để xác định API REST, trái ngược với cách chúng ta tiếp cận điều này trong HotelSpecials API\nVí dụ: Trong HotelSpecials, CloudFormation template đã sử dụng CloudFormation chuẩn để xác định API REST để nó có thể rõ ràng về định nghĩa API và bao gồm swagger. Ví dụ FlightSpecials sử dụng cách tiếp cận khai báo nhiều hơn và để lại thông tin chi tiết cho SAM. Bạn có thể tự do kết hợp CloudFormation và SAM trong cùng một template, như bạn có thể thấy từ các ví dụ này.\nLưu ý rằng biến môi trường $S3_BUCKET được CodeBuild tự động thay thế khi bước xây dựng được thực hiện và được thay thế bằng S3 bucket mà CodeStar đã cung cấp khi thiết lập dự án.\n\rKiểm thử API FlightSpecials Bạn có thể kiểm tra trạng thái của việc triển khai thay đổi mã nguồn thông qua đường dẫn trên CodeStar project dashboard. Khi quá trình triển khai đã hoàn tất thông qua CI/CD pipeline, bạn đã sẵn sàng để kiểm tra API.\n Truy cập API Gateway console trên trình duyệt và vào APIs, chọn iDevelop - Flight Specials API để tiết lộ các tài nguyên cho API. Chọn vào Stages ở dưới iDevelop - Flight Specials API. Mở rộng prod trong danh sách Stages . Chọn vào method GET Chọn vào Invoke URL trong bảng prod - GET - /flightspecials. Sau một lúc khi hàm Lambda được khởi tạo, bạn sẽ thấy kết quả JSON của việc truy vấn cơ sở dữ liệu MySQL từ hàm Lambda. Ví dụ:  {\r\u0026#34;succeeded\u0026#34;: true,\r\u0026#34;message\u0026#34;: \u0026#34;\u0026#34;,\r\u0026#34;errorCode\u0026#34;: 0,\r\u0026#34;data\u0026#34;: [\r{\r\u0026#34;id\u0026#34;: 1,\r\u0026#34;header\u0026#34;: \u0026#34;London to Prague\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Jewel of the East\u0026#34;,\r\u0026#34;cost\u0026#34;: 93,\r\u0026#34;expiryDate\u0026#34;: 1504072439813\r}, {\r\u0026#34;id\u0026#34;: 2,\r\u0026#34;header\u0026#34;: \u0026#34;Paris to London\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Weekend getaway!\u0026#34;,\r\u0026#34;cost\u0026#34;: 182,\r\u0026#34;expiryDate\u0026#34;: 1504074888702\r}\r]\r}\rNếu bạn thấy một JSON payload không có lỗi, bạn đã triển khai thành công một API và hỗ trợ hàm Lambda truy vấn cơ sở dữ liệu MySQL. Lưu ý rằng việc triển khai nhanh hơn và dễ dàng hơn mà không cần bất kỳ sự can thiệp thủ công nào và bạn thậm chí không phải tương tác với AWS CLI hoặc Bảng điều khiển? Mọi thứ được thúc đẩy bởi quá trình đăng ký kiểm soát nguồn.\nBây giờ bạn đã sẵn sàng tích hợp các API này với website TravelBuddy.\n"
},
{
	"uri": "/vi/1-prerequisites/1-create-environment/",
	"title": "Chuẩn bị môi trường",
	"tags": [],
	"description": "",
	"content": "Trong bài thực hành này, chúng ta sẽ sử dụng CloudFormation template đã cung cấp và cài đặt sẵn các tài nguyên cần thiết.\nĐể triển khai ở tài khoản của bạn, bạn có thể sử dụng CloudFormation template\nHoặc tải tập tin bên dưới và triển khai ở dịch vụ CloudFormation: \r\rCloudFormation Template\r\r\rModule6.template.yaml\r\r(52 ko)\r\r\r\rMô hình bên dưới thể hiện các tài nguyên được tạo khi triển khai CloudFormation Template:\nNội dung\n Khởi tạo Keypair Triển khai CloudFormation Template  Khởi tạo Keypair Nếu bạn đã có Keypair được tạo, bạn có thể bỏ qua bước này.\n\r Trước tiên, cần tạo một Keypair cho các máy ảo trong bài thực hành. Truy cập EC2 console, chọn Keypairs Chọn Create key pair  Nhập tên keypair KPforDevAxInstances, chọn định dạng tập tin pem và chọn Create key pair  Một cửa sổ xuất hiện để chọn nơi lưu trữ tập tin keypair. Bạn cần lưu trữ keypair này để truy cập vào máy ảo EC2 trong các bước sau  Triển khai CloudFormation Template  Truy cập AWS CloudFormation  Chọn Create stack, chọn With new resources (standard)  Tại mục Prerequisite - Prepare template chọn Template is ready Tại mục Template source, chọn Upload a template file, nhấp chọn Choose file và trỏ tới file template đã tải xuống. Chọn Next  Nhập tên stack tại mục Stack name (VD: DevAx-M2M-M5) Chọn keypair KPforDevAxInstances cho mục EEKeyPair và chọn Next  Chọn Next tại trang Configure stack options  Chọn Create stack  Chúng ta cần chờ một vài phút để các tài nguyên được khởi tạo và cấu hình.  "
},
{
	"uri": "/vi/1-prerequisites/1-create-environment/1-vpc/",
	"title": "VPC",
	"tags": [],
	"description": "",
	"content": "VPC CloudFormation template định nghĩa một VPC gọi là DevAxNetworkLabVPC chứa 4 mạng con (network subnet) - 2 công khai (các máy ảo được gán với mạng con này có thể được truy cập trực tiếp từ internet) và 2 riêng tư (các mảy ảo được gán với mạng con nào sử dụng private IP và không thể được truy cập trực tiếp từ internet)\n Trong AWS Console, mở VPC Trong bảng điều khiển VPC, chọn Your VPCs, ta thấy một VPC được tạo có tên CdkStack/DevAxNetworkLabVPC.  VPC\nChọn Subnets và Filter với VPC CdkStack/LabVPC bạn sẽ thấy 4 subnets - 2 private và 2 public.  Bài thực hành này sử dụng 2 Availibility Zones (AZs), mỗi AZs có một public và một private subnet. CloudFormation template cũng định nghĩa một Network Address Translation gateway (NAT gateway) thực hiện ánh xạ giữa địa chỉ IP nội bộ của các máy chủ định tuyến qua nó và địa chỉ IP bên ngoài, để các máy ảo dù có private IP nhưng vẫn có thể truy xuất dữ liệu từ Internet. 4. Chọn NAT Gateways. Bạn sẽ thấy 2 NAT gateways, mỗi gateway cho một private subnet truy cập internet và các dịch vụ khác của AWS nhưng ngăn các dịch vụ bên ngoài truy cập trực tiếp với các tài nguyên bên trong các private subnet\n"
},
{
	"uri": "/vi/3-aaa/1-cognito/",
	"title": "Xác thực cho SPA",
	"tags": [],
	"description": "",
	"content": "Thêm Xác thực vào SPA sử dụng Amazon Cognito User Pools\nTrong bài tập này, chúng ta sẽ sử dụng Cognito User Pool và Identity Pool, đồng thời đánh dấu một trong các điểm cuối API của chúng tôi là yêu cầu xác thực qua Cognito User Pools.\n Trong thư mục www, tìm tập tin webapp-configuration.js trong scripts. Trong tập tin này có phần nội dung sau:  (function () {\r\u0026#39;use strict\u0026#39;;\rangular\r.module(\u0026#39;app\u0026#39;)\r.constant(\u0026#39;COGNITO_IDENTITY_POOL_ID\u0026#39;, \u0026#39;REPLACE_WITH_COGNITO_IDENTITY_POOL_ID\u0026#39;)\r.constant(\u0026#39;COGNITO_USER_POOL\u0026#39;, \u0026#39;REPLACE_WITH_COGNITO_USER_POOL\u0026#39;)\r.constant(\u0026#39;COGNITO_USER_POOL_CLIENT_ID\u0026#39;,\u0026#39;REPLACE_WITH_COGNITO_USER_POOL_CLIENT_ID\u0026#39;)\r.constant(\u0026#39;COGNITO_APP_WEB_DOMAIN\u0026#39;, \u0026#39;REPLACE_WITH_S3_BUCKET_WWW\u0026#39;)\r.constant(\u0026#39;AWS_REGION\u0026#39;, \u0026#39;ap-northeast-1\u0026#39;)\r.constant(\u0026#39;APP_BANNER\u0026#39;, \u0026#39;TravelBuddy\u0026#39;)\r})();\rSPA được triển khai bằng cách sử dụng Angular framework, cho phép bạn xác định các hằng số toàn cục được sử dụng làm biến cấu hình trong toàn bộ ứng dụng của bạn. Tệp này xác định các giá trị của biến cấu hình mà bạn cần đặt dựa trên AWS Account\u0026rsquo;s ARN và ID của bạn cho các tài nguyên Cognito khác nhau. Mở tệp webapp-configuration.js trong trình soạn thảo văn bản và giữ nó mở trong khi chúng tôi thực hiện các thay đổi trong các bước sau.\nTruy cập AWS Cognito console bằng các tìm cognito trong thanh tìm kiếm. Nhấn Enter. Chọn Manage your User Pools Chọn TravelBuddy  Trong bảng General Settings, tìm Pool Id và thay cho REPLACE_WITH_COGNITO_USER_POOL trong tập tin webapp-configuration.js. Chọn thiết lập App Client ở mục App integration trong thanh điều hướng bên trái trang Cognito User Pools. Tìm giá trị ID bên dưới mục App client TravelBuddyWebApp và sao chép chúng. Ví dụ:  Thay thế cho giá trị REPLACE_WITH_COGNITO_USER_POOL_CLIENT_ID trong tập tin webapp-configuration.js bằng giá trị của App client ID. Trong Cognito console, chọn Federated Identities ở thanh phía trên và chọn chuyển đổi Cognito Identity Pools manager. Chọn vào liên kết TravelBuddy trong identity pool hiện ra. Trong dashboard xuất hiện, ở thanh điều hướng bên trái, chọn Sample code. Trong mục Get AWS Credentials , ghi nhận lại Identity Pool ID xuất hiện trong đoạn mã ví dụ. Sao chép Identity Pool ID vào bộ nhớ đệm, chúng ta sẽ sử dụng giá trị này sau:  ap-northeast-1:aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeee\rChắc chắn rằng bạn đã sao chép luôn cả nội dung region.\nThay thế giá trị REPLACE_WITH_COGNITO_IDENTITY_POOL_ID trong tập tin webapp-configuration.js bằng giá trị của Identity Pool Id. Trong CloudFormation console của bài thực hành, ở bảng Additional Info, sao chép giá trị S3BucketWWW - tên của S3 bucket chứa ứng dụng đơn trang (SPA) của bạn. Thay thế giá trị REPLACE_WITH_S3_BUCKET_WWW trong tập tin webapp-configuration.js bằng giá trị của S3BucketWWW ở bảng Additional Info. Hoành thành thiết lập tập tin webapp-configuration.js:  (function () {\r\u0026#39;use strict\u0026#39;;\rangular\r.module(\u0026#39;app\u0026#39;)\r.constant(\u0026#39;COGNITO_IDENTITY_POOL_ID\u0026#39;, \u0026#39;ap-northeast-1:429c1d1c-7a5e-4d53-be18-177b806c53a4\u0026#39;)\r.constant(\u0026#39;COGNITO_USER_POOL\u0026#39;, \u0026#39;ap-northeast-1_YSRyht4ck\u0026#39;)\r.constant(\u0026#39;COGNITO_USER_POOL_CLIENT_ID\u0026#39;,\u0026#39;3mh9486bds2f2cr3gio8bdjoik\u0026#39;)\r.constant(\u0026#39;COGNITO_APP_WEB_DOMAIN\u0026#39;, \u0026#39;devax-m6-s3bucketwebsite18ddbcd4-19ewci3z6hece\u0026#39;)\r.constant(\u0026#39;AWS_REGION\u0026#39;, \u0026#39;ap-northeast-1\u0026#39;)\r.constant(\u0026#39;APP_BANNER\u0026#39;, \u0026#39;TravelBuddy\u0026#39;)\r})();\rBây giờ bạn đã thực hiện tất cả các thay đổi bạn cần trong webapp-configuration.js. Lưu và tải tập tin lên S3BucketWWW trong thư mục scripts, ghi đè lên tập tin hiện có. Bạn có thể thực hiện tải lên bằng Console hoặc cửa sổ lệnh. Làm mới trang web TravelBuddy và kiểm tra developer console để xác nhận rằng không có không có lỗi nào sau các thay đổi bạn đã thực hiện.  "
},
{
	"uri": "/vi/2-spa/1-prerequisites/b/",
	"title": "Dùng AWS Cloud9",
	"tags": [],
	"description": "",
	"content": "Sử dụng AWS Cloud9 làm môi trường Phát triển ứng dụng tích hợp Trong phần thực hành này, bạn sẽ sử dụng AWS Cloud9. AWS Cloud9 là một môi trường phát triển tích hợp dựa trên cloud (IDE) cho phép bạn viết, chạy và gỡ lỗi chỉ bằng một trình duyệt. Nó bao gồm một trình soạn thảo mã, trình gỡ lỗi và thiết bị đầu cuối. Cloud9 được đóng gói sẵn với các công cụ cần thiết cho các ngôn ngữ lập trình phổ biến, bao gồm JavaScript, Python, PHP, v.v., vì vậy bạn không cần phải cài đặt tệp hoặc định cấu hình máy phát triển của mình để bắt đầu các dự án mới. Vì Cloud9 IDE của bạn ở trên cloud, nên bạn có thể làm việc trên các dự án của mình từ văn phòng, nhà riêng hoặc bất cứ nơi nào bằng máy có kết nối internet. Cloud9 cũng cung cấp trải nghiệm đồng nhất trong việc phát triển các ứng dụng serverless cho phép bạn dễ dàng xác định tài nguyên, gỡ lỗi và chuyển đổi giữa thực thi local và remote của các ứng dụng serverless. Với Cloud9, bạn có thể nhanh chóng chia sẻ môi trường phát triển với nhóm của mình, cho phép bạn ghép nối chương trình và theo dõi đầu vào của nhau trong thời gian thực.\nNội dung\n Sử dụng AWS Cloud9 làm môi trường Phát triển ứng dụng tích hợp Cài đặt SAM CLI Cài đặt maven Thiết lập DynamoDB    Từ thanh tìm kiếm Services - nhập vào Cloud9 để truy cập console -\u0026gt; Chọn Create environment. Một trang mới xuất hiện để bạn nhập Tên môi trường và chọn Next Step.\n  Mục Environment type, chọn Create a new EC2 Instance for environment (direct access)\n  Mục Instance type, chọn a t3.small\n  Mục Platform, chọn Amazon Linux 2\n  Mục VPC chọn DevAxNetworkVPC (bạn có thể tìm kiếm VPC ID trong AWS Console ở dịch vụ VPC) và chọn subnet giống với máy DevAxWindowsHost trong danh sách máy ảo EC2. Chọn Next step.\n  Kiểm tra lại thiết lập và chọn Create environment. Sẽ mất một vài phút để tiến hành khởi tạo và bạn sẽ được chuyển vào giao diện AWS Cloud9.\nSẽ mất một vài phút để tiến hành khởi tạo\n  Và bạn sẽ được chuyển vào giao diện **AWS Cloud9**.\r Bắt đầu với việc tìm hiểu giao diện của Cloud9, Cloud9 cung cấp cho bạn một giao diện console để làm việc và bạn có thể gỡ lỗi và thiết lập lambda ở vùng bên tai phải. Kiểm tra xem các lambda function đã có trong tài khoản và xem xét chúng. Double click vào CreateGitCredsFunction và import chúng vào IDE. Bạn có thấy gì trong IDE không?  Bây giờ chúng ta cần thiết lập phiên bản JAVA cần thiết là 1.8 và thay đổi các thông số bắt buộc trên IDE. Chúng ta sẽ sử dụng Amazon Corretto, một distro miễn phí, multiplatform, production-ready của OpenJDK. Corretto đi kèm với long-term support sẽ có các cải tiến về hiệu suất và các bản sửa lỗi bảo mật.\r Trong cửa sổ lệnh ở Cloud9, cài đặt Amazon Corretto 8 bằng các lệnh sau:  sudo amazon-linux-extras enable corretto8\rsudo yum install -y java-1.8.0-amazon-corretto-devel\rTrong cửa sổ lệnh ở Cloud9, kiểm tra phiên bản JAVA đã được cài đặt (ở lúc viết bài viết này là 1.8.0_265):  java -version\rBạn sẽ thấy kết quả tương tự bên dưới:\nAdmin:~/environment $ openjdk version \u0026#34;1.8.0_265\u0026#34;\rOpenJDK Runtime Environment Corretto-8.265.01.1 (build 1.8.0_265-b01)\rOpenJDK 64-Bit Server VM Corretto-8.265.01.1 (build 25.265-b01, mixed mode)\rCài đặt SAM CLI Chúng ta sẽ cài đặt AWS Serverless Application Model (SAM) CLI vào môi trường AWS Cloud9 của chúng ta. AWS Serverless Application Model (SAM) là một open-source framework để xây dựng các ứng dụng serverless. Nó cung cấp cú pháp viết tắt để diễn đạt các hàm, API, cơ sở dữ liệu và ánh xạ nguồn sự kiện. Chỉ với một vài dòng trên mỗi tài nguyên, bạn có thể xác định ứng dụng bạn muốn và lập model ứng dụng đó bằng YAML. Trong quá trình triển khai, SAM chuyển đổi và mở rộng cú pháp SAM thành cú pháp AWS CloudFormation, cho phép bạn xây dựng các ứng dụng serverless nhanh hơn.\nTrong cửa sổ lệnh ở Cloud9, cài đặt SAM CLI với câu lệnh sau:  sudo pip3 install --upgrade aws-sam-cli\rCài đặt maven Chúng ta sẽ sử dụng Apache Maven để quản lý việc xây dựng dự án và quản lý các thư viện cho dự án của chúng tôi.\nTrong cửa sổ lệnh ở Cloud9, cài đặt Apache Maven với câu lệnh sau:  sudo wget http://repos.fedorapeople.org/repos/dchen/apache-maven/epel-apache-maven.repo -O /etc/yum.repos.d/epel-apache-maven.repo\rsudo sed -i s/\\$releasever/6/g /etc/yum.repos.d/epel-apache-maven.repo\rsudo yum install -y apache-maven\rKhông may, trình cài đặt maven chuyển JDK của chúng ta thành 1.7, vì vậy chúng ta cần chuyển về 1.8 9.\nTo switch our JDK to Corretto 8, issue the following commands in the Cloud9 terminal:  sudo alternatives --config java #enter the number for corretto 8\rsudo alternatives --config javac #enter the number for corretto 8\rBạn sẽ thấy một cái gì đó tương tự như sau:\nThiết lập DynamoDB Chúng ta sẽ cần thực hiện đưa dữ liệu vào trong DynamoDB table, các thông tin này sẽ được sử dụng xuyên suốt bài thực hành. Dữ liệu này sẽ được sử dụng để tính toán các chuyến đi giữa các thành phố với nhau.\nTải tập tin sau về môi trường cửa sổ lệnh AWS Cloud9: populate_tripsector.sh  \r\rDB file\r\r\rpopulate_tripsector.sh\r\r(1 ko)\r\r\r\rThực thi câu lệnh sau trong AWS Cloud9 terminal.  bash populate_tripsector.sh \u0026lt;AWS_REGION\u0026gt;\rMở dịch vụ DynamoDB trong AWS Console và kiểm tra table TravelBuddyTripSectors. Hãy chắc chắn rằng đã có 50 bản ghi được thêm vào trong table.  "
},
{
	"uri": "/vi/2-spa/4-codestar-cicd/b/",
	"title": "Dùng AWS Cloud9",
	"tags": [],
	"description": "",
	"content": "Dịch vụ vi mô tiếp theo mà chúng ta cần cho ứng dụng không máy chủ TravelBuddy của chúng ta là FlightSpecials API. Chúng ta đã xem FlightSpecials trước đây trong các phần trước, vì vậy nó sẽ quen thuộc với bạn. Nó hoạt động giống như HotelSpecials API ở chỗ nó phải được triển khai tích hợp với VPC để nó có thể kết nối với cơ sở dữ liệu MySQL để truy vấn dữ liệu. Thay vì đóng gói và triển khai microservice này theo cách thủ công, chúng ta sẽ sử dụng CodeStar để xây dựng CI/CD pipeline đầy đủ cho chúng ta, như chúng ta đã làm trong các bài thực hành trước đây. Vì vậy, do bạn đã tạo CI/CD pipeline bằng AWS CodeStar một vài lần, nên chúng ta sẽ không cung cấp cho bạn hướng dẫn từng bước đầy đủ. Nếu bạn cần trợ giúp, hãy tham khảo các tài liệu về cách hoàn thành các tác vụ cần thiết để tạo một dự án CodeStar mới và triển khai mã FlightSpecials trên ứng dụng mẫu do CodeStar cung cấp.\nNội dung\n Tạo một CI/CD pipeline với AWS CodeStar Cập nhật các thông số trong CloudFormation template Cập nhật AWS region trong tập tin định nghĩa API swagger.yml Tạo CodeStar Project Thiết lập CodeCommit trên AWS Cloud9 Kiểm tra các thay đổi đưa vào quản lý mã nguồn để kích hoạt quá trình triển khai Kiểm thử API FlightSpecials  Tạo một CI/CD pipeline với AWS CodeStar  Tạo một project AWS CodeStar Web Service mới với mục tiêu là Java trên AWS Lambda. Đặt tên cho project là FlightSpecialsAPI.\nBạn có thể tham khảo thêm tại Tài liệu CodeStar. Tạo một project AWS CodeStar từ Cloud9 IDE. Xem thêm tài liệu nếu bạn cần tham khảo.\nNếu sử dụng Cloud9, hãy nhớ thêm git config helpers.  cd ~/environment\raws codestar create-project --generate-cli-skeleton | tee template.yml\rThis will create a template.yml file with the base skeleton. It requires details the following details to be updated. You can think of this as an overlay to create your CodeStar project, which will use the toolchain and zip file for your creation of the codestar project\n S3 bucket name and key: This is the details for codestar deployment on where to grab the build for the pipeline. Destination: This is the name of the codecommit repository or github repository, we are only using codecommit, but you can adapt this if you need to grab from your github repo. Toolchain: this is a cloudformation template which sets up the required toolchain elements. It is the same as what has been done for you in eclipse, and will will create the following resources.  CodeCommit - s3bucket and policies to store the artifact CodeCommit event - codecommit change occurs to action a new build CodeBuild project - to build based off of the buildspec.yml CodePipeline - project pipeline which will action all the required phases    Tải về và mở tập tin toolchain.yml  Chúng ta cần thay đổi các chi tiết cho tập tin toolchain.yml để trỏ đến đúng docker container sẽ được sử dụng. Docker container có tất cả các yêu cầu được xây dựng sẵn dựa trên các yêu cầu khác nhau. Trong trang web này, hãy tìm cái phù hợp với yêu cầu JAVA 1.8, maven của chúng ta. https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-available.html\nTrong toolchain.yml tìm docker container hiện tại sẽ trông như sau:\nCodeBuildProject:\rDependsOn:\r- CodeBuildPolicy\rProperties:\rArtifacts:\rPackaging: zip\rType: codepipeline\rCache:\rType: S3\rLocation: !Sub \u0026#39;${S3Bucket}/codebuildcache\u0026#39;\rDescription: !Sub \u0026#34;AWS CodeStar created CodeBuild Project for ${ProjectId}\u0026#34;\rEnvironment:\rComputeType: small\r# This environment variable informs AWS CodeBuild where it can retrieve your code artifact.\r # You can specify any other environment variables your buildspec.yml is looking for.\r EnvironmentVariables:\r- Name: S3_BUCKET\rValue: !Ref \u0026#39;S3Bucket\u0026#39;\r# Replace this Docker image if necessary: https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-available.html\r Image: aws/codebuild/eb-nodejs-6.10.0-amazonlinux-64:4.0.0\rType: LINUX_CONTAINER\rThay đổi hình ảnh thành phiên bản bạn cần cho java.  aws codebuild list-curated-environment-images\rBạn cũng có thể làm điều này bằng cách truy vấn json payload:  aws codebuild list-curated-environment-images --query \u0026#34;platforms[].languages[?language==\u0026#39;JAVA\u0026#39;].images\u0026#34;\rThay thế cái mới nhất trong toolchain.yml: Image:aws/codebuild/eb-java-8-amazonlinux-64:2.4.3-1.0.0  Hãy nhớ thay đổi những điều này khi các phiên bản mới hơn được phát hành để đảm bảo rằng bạn đang sử dụng phiên bản mới nhất.\nPhần khác cần xem lại là cách bộ nhớ đệm và buildspec hoạt động. Lưu ý thành phần bộ nhớ cache:\nCache:\rType: S3\rLocation: !Sub \u0026#39;${S3Bucket}/codebuildcache\u0026#39;\rĐây là thiết lập cho một S3 bucket, được sử dụng trong thiết lập cho tập tin buildspec.yml được hiển thị bên dưới:\ncache:\rpaths:\r- \u0026#39;/root/.m2/**/*\u0026#39;\rBạn cũng cần cung cấp service role bắt buộc cho template.yml mà bạn đã tạo. Để lấy ví dụ về điều này, bạn có thể làm như sau:  aws codestar create-project help\r# check the examples to get the service role : \u0026#34;roleArn\u0026#34;: \u0026#34;arn:aws:iam::123456789012:role/service-role/aws-codestar-service-role\u0026#34;\rTải về mã nguồn của FlightSpecials và giải nén trong môi trường làm việc của bạn  \r\rMã nguồn FlightSpecials\r\r\rFlightSpecials.zip\r\r(18 ko)\r\r\r\rCập nhật các thông số trong CloudFormation template Chỉnh sửa tập tin FlightSpecials/template_cloud9.yml và thay thế chúng bằng các giá trị được tìm thấy trong Cloudformation Outputs:     Mục để thay thế Mô tả      Mạng con đầu tiên cho cơ sở dữ liệu MySQL    Mạng con thứ hai cho cơ sở dữ liệu MySQL    Security group cho cơ sở dữ liệu MySQL    MySQL database endpoint    Khi bạn đã cập nhật xong các giá trị, mục VPCConfig sẽ trông tương tự như sau (với các giá trị khác nhau):\nVpcConfig:\rSecurityGroupIds:\r- sg-858e61e3\rSubnetIds:\r- subnet-3c989d4a\r- subnet-a04255c4\rEnvironment:\rVariables:\rJDBC_CONNECTION_STRING: jdbc:mysql://qlxx5jzrxxxby.cig0rzmdedgf.ap-northeast-1.rds.amazonaws.com:3306/travelbuddy?useSSL=false\u0026amp;serverTimezone=UTC\u0026amp;autoReconnect=true\rJDBC_UID: root\rJDBC_PWD: labpassword\rCập nhật AWS region trong tập tin định nghĩa API swagger.yml Tập tin swagger.yml được cung cấp trong gói zip là định nghĩa cho API sẽ cung cấp microservice thông qua Amazon API Gateway. Nó cần được cập nhật thông tin chi tiết về AWS Account ID trong bài thực hành của bạn và Region AWS mục tiêu trước khi bạn có thể triển khai dịch vụ vi mô của mình.\nTrong Cloud9 IDE, tìm tập tin swagger.yml và mở ra trong trình soạn thảo văn bản. Tìm kiếm REPLACE_AWS_REGION và thay thế nó bằng khu vực bạn đang sử dụng(VD: ap-northeast-1) Tìm kiếm REPLACE_AWS_ACCOUNTID và thay thế nó bằng AWS Account Id. Bạn có thể tìm thấy AWS Account ID của mình trong trang tổng quan của bài thực hành. Lưu tập tin. Khi gói tập tin zip được sử dụng trong codedeploy, bạn cần phải gói từ thư mục nguồn. Để làm điều này, hãy chạy như sau:  cd ~/environment/FlightSpecials\rzip -r ../FlightSpecials.zip *\rNén tập tin FlightSpecials.zip với các cập nhật.  cd ~/environment\rrm FlightSpecials.zip\rcd FlightSpecials\rzip -r FlightSpecials.zip *\radding: buildspec.yml (deflated 53%)\radding: copy_files.sh (deflated 63%)\radding: pom.xml (deflated 75%)\radding: src/ (stored 0%)\radding: src/test/ (stored 0%)\radding: src/test/java/ (stored 0%)\radding: src/test/java/devlounge/ (stored 0%)\radding: src/test/java/devlounge/lambda/ (stored 0%)\radding: src/test/java/devlounge/lambda/test/ (stored 0%)\radding: src/test/java/devlounge/lambda/test/TestContext.java (deflated 76%)\radding: src/test/java/devlounge/lambda/test/TestUtils.java (deflated 79%)\radding: src/test/java/devlounge/lambda/test/LambdaFunctionHandlerTest.java (deflated 57%)\radding: src/main/ (stored 0%)\radding: src/main/java/ (stored 0%)\radding: src/main/java/devlounge/ (stored 0%)\radding: src/main/java/devlounge/model/ (stored 0%)\radding: src/main/java/devlounge/model/FlightSpecial.java (deflated 73%)\radding: src/main/java/devlounge/model/LambdaResult.java (deflated 62%)\radding: src/main/java/devlounge/lambda/ (stored 0%)\radding: src/main/java/devlounge/lambda/FlightSpecialsHandler.java (deflated 65%)\radding: swagger.yml (deflated 68%)\radding: template-configuration.json (deflated 18%)\radding: template.yml (deflated 65%)\r\rLưu ý rằng thư mục FlightSpecials hiện đã bị bỏ qua, điều này rất quan trọng để bắt buộc chỉ có mã nguồn ở đó.\n\rLưu ý rằng cấu trúc thư mục ở đây là ** THỰC SỰ ** quan trọng: https://docs.aws.amazon.com/codebuild/latest/userguide/getting-started-cli-upload-source-code.html\n\rTạo CodeStar Project Sao chép mã vào FlightSpecials. Bucket thực hành của bạn sẽ trông giống như thế này mod-9c10d0af24f74a4a-s3bucketlambdacode-vsuckr33vysr  aws s3 cp FlightSpecials.zip s3://\u0026lt;Lambdabucket\u0026gt;\rSao chép tập tin toolchain.yml vào Lamdba bucket  aws s3 cp toolchain.yml s3://\u0026lt;Lambdabucket\u0026gt;\rTạo codepipeline template cho flightspecials, sẽ giống như sau:  Thay đổi XXX bằng tài khoản của bạn bên dưới để template hoạt động.\n{\r\u0026#34;name\u0026#34;: \u0026#34;flightspecials\u0026#34;,\r\u0026#34;id\u0026#34;: \u0026#34;flightspecials\u0026#34;,\r\u0026#34;description\u0026#34;: \u0026#34;flight specials java8 example using ci/cd\u0026#34;,\r\u0026#34;sourceCode\u0026#34;: [\r{\r\u0026#34;source\u0026#34;: {\r\u0026#34;s3\u0026#34;: {\r\u0026#34;bucketName\u0026#34;: \u0026#34;\u0026lt;Lambdabucket\u0026gt;\u0026#34;,\r\u0026#34;bucketKey\u0026#34;: \u0026#34;FlightSpecials.zip\u0026#34;\r}\r},\r\u0026#34;destination\u0026#34;: {\r\u0026#34;codeCommit\u0026#34;: {\r\u0026#34;name\u0026#34;: \u0026#34;flightspecials\u0026#34;\r}\r}\r}\r],\r\u0026#34;toolchain\u0026#34;: {\r\u0026#34;source\u0026#34;: {\r\u0026#34;s3\u0026#34;: {\r\u0026#34;bucketName\u0026#34;: \u0026#34;\u0026lt;Lambdabucket\u0026gt;\u0026#34;,\r\u0026#34;bucketKey\u0026#34;: \u0026#34;toolchain.yml\u0026#34;\r}\r},\r\u0026#34;roleArn\u0026#34;: \u0026#34;arn:aws:iam::XXX:role/service-role/aws-codestar-service-role\u0026#34;,\r\u0026#34;stackParameters\u0026#34;: {\r\u0026#34;ProjectId\u0026#34;: \u0026#34;flightspecials\u0026#34;\r}\r}\r}\rTạo project AWS Codestar:  aws codestar create-project --cli-input-json file://template.json\r{\r\u0026#34;arn\u0026#34;: \u0026#34;arn:aws:codestar:ap-northeast-1:436753246579:project/flightspecials\u0026#34;\r}\rBây giờ hãy kiểm tra thông tin CloudFormation đã hoàn thành, repo CodeCommit đã tạo và bản build đầu tiên đã được khởi động.\nNếu bất kỳ lỗi nào trong số này không thành công, hãy xem các lỗi. Bạn sẽ cần xóa s3 bucket đã tạo và tạo lại nếu có bất kỳ sự cố nào. Nếu bạn đang thay đổi bất kỳ mã nào cho FlightSpecials.zip và hãy nhớ tải lên bucket.\nĐể kiểm tra hoạt động : aws codestar describe-project --id flightspecials\nThiết lập CodeCommit trên AWS Cloud9 Sau khi tạo xong, bạn cần thiết lập git repo cần thiết cho codecommit mà bạn đã định cấu hình trước đó.\nDi chuyển tập tin zip ban đầu, vì đây chỉ là tệp tải lên lần đầu tiên, sau đó thiết lập helper class cần thiết và tải về repository của bạn.  mv FlightSpecials FlightSpecials_orig\rgit config --global credential.helper \u0026#39;!aws codecommit credential-helper $@\u0026#39;\rgit config --global credential.UseHttpPath true\rgit clone https://git-codecommit.ap-northeast-1.amazonaws.com/v1/repos/flightspecials\rcd flightspecials\rCấp quyền cho CloudFormation để tạo IAM role\nLà một phần của việc thiết lập microservice của chúng ta, chúng ta sẽ chỉ định IAM Role mới cho hàm Lambda của chúng ta để cho phép nó thực hiện các tác vụ khác nhau. Khi CodeStar tạo project, nó đã tạo một IAM Role cấp cho CloudFormation vừa đủ quyền để triển khai dịch vụ Hello World example. Các quyền này không đủ cho các yêu cầu nâng cao hơn của chúng ta. Vì vậy, chúng ta cần điều chỉnh các chính sách được chỉ định cho CloudFormation role, để mở rộng các quyền đó.\nTruy cập AWS IAM Console trên trình duyệt. Chọn Roles ở thanh điều hướng bên trái. Trong ô Filter nhập CodeStarWorker-flightspecialsa-CloudFormation để tìm đúng IAM Role.  Nếu bạn không thể tìm thấy role, có thể do còn quá sớm - CodeStar vẫn đang trong quy trình cấp phát và có thể chưa tạo role. Kiểm tra tiến trình cung cấp trong CodeStar dashboard.\n\rChọn vào role để mở bảng thông tin chi tiết. Chọn Attach Policy, trong ô Filter nhập idevelop để chọn các chính sách có sẵn. Chọn chính sách idevelopCodeStarCloudFormationPolicy trong danh sách. Chính sách này đã được tạo cho bạn bởi quá trình thiết lập bài thực hành và có các quyền được chỉ định cho nó để cho phép CloudFormation làm việc thay mặt chúng ta khi tạo role thực thi Lambda. Chọn chính sách được liệt kê và nhấp vào Attach Policy  Kiểm tra các thay đổi đưa vào quản lý mã nguồn để kích hoạt quá trình triển khai Bây giờ bạn đã hoàn tất cập nhật tập tin, bạn cần thêm các tập tin đã thay đổi vào new-implementation git branch và xác nhận các thay đổi. Bạn có thể dùng Cloud9 IDE: - Thực thi git status để kiểm tra lại các thay đổi về code. - Thực thi git add . để thêm vào các tập tin đã thay đổi. - Thực thi git commit -m \u0026quot;Baseline implementation\u0026quot; xác nhận các thay đổi và cung cấp một thông báo - Thực thi git checkout master để chuyển trở lại master branch - Bây giờ hợp nhất các thay đổi cho triển khai mới của bạn vào nhánh chính bằng cách phát hành git merge new-implementation - Đẩy các thay đổi lên CodeCommit.  Sẽ mất một vài phút để đẩy mã và bắt đầu triển khai. Kiểm tra mã nguồn và các template sẽ kích hoạt quá trình xây dựng và triển khai thực hiện mới. AWS CodePipeline hiện sẽ sử dụng CloudFormation để triển khai các tài nguyên sau:\nTrong khi bạn có chút thời gian, hãy dành vài phút để khám phá buildspec.yml, swagger.yml và template.yml các tệp xác định Amazon API Gateway, hàm AWS Lambda và quá trình build/deploy thông qua AWS CodeBuild. Bạn sẽ nhận thấy rằng tập tin builspec.yml sử dụng cùng một lệnh AWS CLI để đóng gói triển khai mà bạn đã sử dụng khi đóng gói HotelSpecials API theo cách thủ công trước đó\nĐừng thực thi lệnh bên dưới, chúng chỉ để bạn tham khảo thêm.\n\rmvn package shade:shade\raws cloudformation package --template template.yml --s3-bucket $S3_BUCKET --output-template template-export.yml\rTập tin template.yml sử dụng Serverless Application Model (SAM) chuyển đổi để xác định API REST, trái ngược với cách chúng ta tiếp cận điều này trong HotelSpecials API\nVí dụ: Trong HotelSpecials, CloudFormation template đã sử dụng CloudFormation chuẩn để xác định API REST để nó có thể rõ ràng về định nghĩa API và bao gồm swagger. Ví dụ FlightSpecials sử dụng cách tiếp cận khai báo nhiều hơn và để lại thông tin chi tiết cho SAM. Bạn có thể tự do kết hợp CloudFormation và SAM trong cùng một template, như bạn có thể thấy từ các ví dụ này.\nLưu ý rằng biến môi trường $S3_BUCKET được CodeBuild tự động thay thế khi bước xây dựng được thực hiện và được thay thế bằng S3 bucket mà CodeStar đã cung cấp khi thiết lập dự án.\n\rKiểm thử API FlightSpecials Bạn có thể kiểm tra trạng thái của việc triển khai thay đổi mã nguồn thông qua đường dẫn trên CodeStar project dashboard. Khi quá trình triển khai đã hoàn tất thông qua CI/CD pipeline, bạn đã sẵn sàng để kiểm tra API.\nTruy cập API Gateway console trên trình duyệt và vào APIs, chọn iDevelop - Flight Specials API để tiết lộ các tài nguyên cho API. Chọn vào Stages ở dưới iDevelop - Flight Specials API. Mở rộng prod trong danh sách Stages . Chọn vào method GET Chọn vào Invoke URL trong bảng prod - GET - /flightspecials. Sau một lúc khi hàm Lambda được khởi tạo, bạn sẽ thấy kết quả JSON của việc truy vấn cơ sở dữ liệu MySQL từ hàm Lambda. Ví dụ:  {\r\u0026#34;succeeded\u0026#34;: true,\r\u0026#34;message\u0026#34;: \u0026#34;\u0026#34;,\r\u0026#34;errorCode\u0026#34;: 0,\r\u0026#34;data\u0026#34;: [\r{\r\u0026#34;id\u0026#34;: 1,\r\u0026#34;header\u0026#34;: \u0026#34;London to Prague\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Jewel of the East\u0026#34;,\r\u0026#34;cost\u0026#34;: 93,\r\u0026#34;expiryDate\u0026#34;: 1504072439813\r}, {\r\u0026#34;id\u0026#34;: 2,\r\u0026#34;header\u0026#34;: \u0026#34;Paris to London\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Weekend getaway!\u0026#34;,\r\u0026#34;cost\u0026#34;: 182,\r\u0026#34;expiryDate\u0026#34;: 1504074888702\r}\r]\r}\rNếu bạn thấy một JSON payload không có lỗi, bạn đã triển khai thành công một API và hỗ trợ hàm Lambda truy vấn cơ sở dữ liệu MySQL. Lưu ý rằng việc triển khai nhanh hơn và dễ dàng hơn mà không cần bất kỳ sự can thiệp thủ công nào và bạn thậm chí không phải tương tác với AWS CLI hoặc Bảng điều khiển? Mọi thứ được thúc đẩy bởi quá trình đăng ký kiểm soát nguồn.\nBây giờ bạn đã sẵn sàng tích hợp các API này với website TravelBuddy.\n"
},
{
	"uri": "/vi/2-spa/2-build-deploy/",
	"title": "Serverless Microservices",
	"tags": [],
	"description": "",
	"content": "Xây dựng và Triển khai Serverless Microservice thủ công\nIn this exercise, you will manually create and configure a serverless microservice. As you progress through this lab, you will use other techniques for build and deployment, so that you can compare and contrast the efficiencies of each approach and how automation makes the development experience more agile and increases developer efficiency.\nTrong bài tập này, bạn sẽ tự tạo và cấu hình một serverless microservice. Trong quá trình làm bài thực hành, bạn sẽ sử dụng các kỹ thuật khác nhau để xây dựng và triển khai, khi đó bạn có thể so sánh và đối chiếu hiệu quả của từng cách tiếp cận và phương pháp tự động hóa làm cho việc phát triển ứng dụng trở nên nhanh hơn và hiệu quả hơn cho các developer.\nBạn sẽ tạo thủ công TripSearch microservice. TripSearch microservice cung cấp các hàm sau:\n  /trips - trả về danh sách tất cả các chuyến đi có sẵn trong hệ thống. /tripsfromcity - trả về danh sách tất cả các chuyến đi xuất phát từ một thành phố nhất định. /tripstocity - trả về danh sách tất cả các chuyến đi có điểm đến là một thành phố nhất định   Đây là cùng một microservice mà chúng ta đã xem xét trong bài thực hành trước đây. Nhưng lần này, chúng ta sẽ cung cấp chức năng này trong trang web TravelBuddy của chúng ta và do đó, cần triển khai dịch vụ để chuẩn bị cho trang web. Trước đây, việc cấu hình API Gateway được quản lý bởi pipeline triển khai cho bạn - trong bài tập này, bạn sẽ cấu hình thủ công thiết cho cả hàm Lambda và API Gateway.\nNội dung\n Tải mã nguồn và xây dựng thành phần cho triển khai Tại sao bạn lại thấy thông báo AWS X-ray unavailable - ignoring? Tạo hai hàm Lambda mới sử dụng chung cá thành phần triển khai  Tải mã nguồn và xây dựng thành phần cho triển khai  Bài thực hành này đã tạo sẵn một S3 bucket để bạn lưu trữ thành phần triển khai cho hàm Lambda cho TripSearch microservice. Trước tiên, bạn cần kiểm thử và xây dựng gói triển khai.\nTải về mã nguồn tại TripSearchFull.zip và giải nén tập tin zip trong hệ thống của bạn. Bạn có thể thực hiện trên hệ điều hành Windows hay Cloud9. Lệnh sau sẽ thực hiện tải về gói mã nguồn:  curl -L http://workshops.devax.academy/monoliths-to-microservices/module6/files/TripSearchFull.zip --output TripSearchFull.zip\rHoặc tải về bên dưới:\n\r\rSource code bundle\r\r\rTripSearchFull.zip\r\r(21 ko)\r\r\r\rcd vào vị trí đặt thư mục giải nén mã nguồn TripSearchFullvà chạy unit test bằng lệnh sau:  Với MacOS/Linux:\nexport DDB_TABLENAME_TRIPSECTOR=TravelBuddyTripSectors; mvn test\rVới Windows:\nset DDB_TABLENAME_TRIPSECTOR=TravelBuddyTripSectors\rmvn test\rVới Cloud9 - Nếu bạn chưa thiết lập:\nset DDB_TAB\rsudo yum install -y java-1.8.0-openjdk-devel\rsudo alternatives --config java #enter 1.8 version #enter 2\rsudo alternatives --config javac #enter 1.8 version #enter 2\rsudo yum remove -y java-1.7.0-openjdk-devel\rsudo wget http://repos.fedorapeople.org/repos/dchen/apache-maven/epel-apache-maven.repo -O /etc/yum.repos.d/epel-apache-maven.repo\rsudo sed -i s/\\$releasever/6/g /etc/yum.repos.d/epel-apache-maven.repo\rsudo yum install -y apache-maven\rChạy kiểm thử trên Cloud9:\nexport DDB_TABLENAME_TRIPSECTOR=TravelBuddyTripSectors; mvn test\r\rNếu việc kiểm thử ra kết quả fail, hãy thử thiết lập lại profile aws mặc định cho hệ thống của bạn. Trên Windows: set AWS_PROFILE=devaxacademy Trên MacOS/Linux: export AWS_PROFILE=devaxacademy\n\rNếu việc kiểm thử vẫn ra kết quả fail, có thể là do môi trường bài thực hành chưa được triển khai xong. Hãy kiểm tra và chắc chắn template đã được triển khai hoàn thành.\n\rNếu việc kiểm thử tiếp tục ra kết quả fail và thông báo lỗi đầu tiên là \u0026ldquo;Unable to load AWS credentials from any provider in the chain\u0026rdquo;. Hãy kiểm tra và chắc chắn bạn đã thiết lập thông tin đăng nhập cho AWS CLI.\n\rLệnh này đặt tên table cho DynamoDB table khớp với tên của bảng do thiết lập của bài thực hành đặt. Bạn sẽ thấy kết quả như sau:\n2021-03-30 18:03:55 \u0026lt;\u0026gt; WARN BasicProfileConfigLoader:96 - The legacy profile format requires the \u0026#39;profile \u0026#39; prefix before the profile name. The latest code does not require\rsuch prefix, and will consider it as part of the profile name. Please remove the prefix if you are seeing this warning.\rEnvVar DDB_TABLENAME_TRIPSECTOR detected - overriding DDB TableName to TravelBuddyTripSectors\rAWS X-ray unavailable - ignoring\rFound 52 total trips.\rSun Jun 20 23:52:23 UTC 2021 \u0026gt; Melbourne to Geelong on Qantas\rTue Jun 15 02:12:51 UTC 2021 \u0026gt; Geelong to Brisbane on Qantas\rTue Aug 17 20:29:29 UTC 2021 \u0026gt; Melbourne to Cairo on Qantas\rSat Mar 12 23:18:51 UTC 2022 \u0026gt; Sydney to Singapore on Qantas\rThu May 27 02:55:51 UTC 2021 \u0026gt; Perth to Hobart on Qantas\r.....\u0026lt;omitted\u0026gt;\rStarting devlounge.lambda.FindTripsFromCityHandler Lambda with input Melbourne\rAWS X-ray unavailable - ignoring\rFound 8 total trips.\rSun Jun 20 23:52:23 UTC 2021 \u0026gt; Melbourne to Geelong on Qantas\rTue Aug 17 20:29:29 UTC 2021 \u0026gt; Melbourne to Cairo on Qantas\rTue Jun 08 04:55:44 UTC 2021 \u0026gt; Melbourne to Dallas on Qantas\rThu Dec 09 22:15:45 UTC 2021 \u0026gt; Melbourne to Singapore on Qantas\rTue Jun 15 06:55:59 UTC 2021 \u0026gt; Melbourne to Broome on Qantas\rSun Dec 19 18:06:06 UTC 2021 \u0026gt; Melbourne to Geelong on Qantas\rFri Apr 09 05:45:41 UTC 2021 \u0026gt; Melbourne to Newcastle on Qantas\rSun Apr 03 15:19:34 UTC 2022 \u0026gt; Melbourne to Sydney on Qantas\rStarting devlounge.lambda.FindTripsToCityHandler Lambda with city Sydney\rAWS X-ray unavailable - ignoring\rFound 2 total trips.\rMon Feb 28 19:39:13 UTC 2022 \u0026gt; Perth to Sydney on Qantas\rSun Apr 03 15:19:34 UTC 2022 \u0026gt; Melbourne to Sydney on Qantas\rTests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.111 sec\rResults :\rTests run: 1, Failures: 0, Errors: 0, Skipped: 0\r\rNhớ rằng thành phố đi và đến thể hiện ở đây và thời gian, ngày tháng sẽ khác so với môi trường triển khai của bạn vì nó được tạo ngẫu nhiên.\n\rBạn sẽ thấy không có thông báo lỗi nào khi chạy unit test và điều đó chắc chắn rằng mã nguồn của bạn đã chạy được như dự kiến. Nếu vẫn thấy lỗi, hãy thử kiểm tra thêm.\n\rTại sao bạn lại thấy thông báo AWS X-ray unavailable - ignoring? Khi bạn chạy test trong môi trường Development local, AWS X-RAy agent không khả dụng, và vì như vậy việc gọi từ AWS SDK không được ghi nhận vào X-Ray. Tuy nhiên, thiết lập trong pom.xml xác định sử dụng AWS X-Ray recorder, tất cả các lệnh gọi tới thông qua SDK (VD: gọi tới DynamoDB) sẽ được ghi nhận. Việc này sẽ gây phát sinh lỗi và test sẽ fail.\nChú ý rằng mỗi một lớp Lambda handler đều extend từ một lớp nền tên là LambdaHandlerWithXRayBase. Trong lớp này, có một khởi tạo static và nó xây dựng đối tượn ContextMissingStrategy, ghi đè hành động khi không có AWS X-Ray và thiết lập đó là hành động mặc định. Trong quá trình triển khai contextMissing handler, chúng ta có xuất ra một nội dung ra console, thay vì hành động mặc định là đưa ra exception. Việc triển khai lớp LambdaHandlerWithXRayBase tương tự như sau:\npublic class LambdaHandlerWithXRayBase {\rstatic {\rAWSXRayRecorderBuilder builder = AWSXRayRecorderBuilder.standard();\rbuilder.withContextMissingStrategy(new ContextMissingStrategy() {\t@Override\rpublic void contextMissing(String arg0, Class\u0026lt;? extends RuntimeException\u0026gt; arg1) { System.out.println(\u0026#34;AWS X-ray unavailable - ignoring\u0026#34;); }\t});\rAWSXRay.setGlobalRecorder(builder.build());\r}\r}\rLà một thử nghiệm tùy chọn, bạn có thể thử xóa trình khởi tạo static khỏi lớp cơ sở LambdaHandlerWithXRayBase và chạy lại Maven build. Bạn sẽ thấy các lỗi như:\ncom.amazonaws.xray.exceptions.SegmentNotFoundException: Thread failed to begin a subsegment: segment not found. Verify that a segment is in progress, and that the SegmentContextResolverChain is configured correctly in order to discover the segment.\rNếu không có agent, và lệnh gọi hàm Lambda trong trường hợp Id tương quan được chuyển chính xác đến nó, SegmentContextResolverChain không thể xác định phân vùng AWS X-ray để đính kèm metadata đã ghi vào và đưa ra exception. Việc triển khai chúng ta cung cấp trong lớp cơ sở sẽ ghi đè hành vi này, nhằm bỏ qua điều kiện này một cách an toàn trong khi thử nghiệm trên môi trường phát triển của bạn.\nNếu quá trình chạy unit test thành công, bạn đã sẵn sàng xây dựng thành phần triển khai. Từ dòng lệnh, hãy thực hiện như sau:  mvn package shade:shade\rKết quả triển khai (tệp JAR) sẽ được xây dựng và lưu trữ trong ./target/tripsearch-1.0.0.jar  Trong trường hợp cần tạo hàm AWS Lambda từ tập tin JAR. Bạn cần đẩy các build artifact vào S3BucketLambdaCode S3 bucket có thể được truy cập bởi môi trường AWS Lambda trong cùng Region mà hàm Lambda đã được tạo. Thực thi lệnh bên dưới sau khi thay đổi một số thông số cho phù hợp:\naws s3 cp target/tripsearch-1.0.0.jar s3://\u0026lt;S3BucketLambdaCode\u0026gt; --region ap-northeast-1\r\rThay giá trị trong Cloudformation Outputs bằng giá trị của S3BucketLambdaCodeBucketName. Không thêm ký tự *\u0026lt;* và **\u0026gt;**.\n\rTạo một hàm Lambda mới từ cấu phần triển khai này, bằng cách thực thi lệnh sau sau khi thay thế các tham số liên quan được ghi chú bên dưới:  aws lambda create-function --function-name idevelopTripSearchFull --runtime java8 --role \u0026lt;LambdaRole\u0026gt; --handler devlounge.lambda.FindAllTripsHandler --code S3Bucket=\u0026lt;S3BucketLambdaCode\u0026gt;,S3Key=tripsearch-1.0.0.jar --timeout 15 --description \u0026#34;TravelBuddy TripSearch microservice - FindAllTrips\u0026#34; --memory-size 1024 --region ap-northeast-1\r\rThay giá trị trong Cloudformation Outputs bằng giá trị của S3BucketLambdaCodeBucketName. Thay giá trị trong Cloudformation Outputs thay cho khóa LambdaRoleARN. Không thêm ký tự *\u0026lt;* và **\u0026gt;**.\n\rNếu thành công, hàm Lambda mới của bạn sẽ được tạo và bạn sẽ thấy kết quả trả về tương tự như sau:\n{\r\u0026#34;FunctionName\u0026#34;: \u0026#34;idevelopTripSearchFull\u0026#34;,\r\u0026#34;FunctionArn\u0026#34;: \u0026#34;arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:idevelopTripSearchFull\u0026#34;,\r\u0026#34;Runtime\u0026#34;: \u0026#34;java8\u0026#34;,\r\u0026#34;Role\u0026#34;: \u0026#34;arn:aws:iam::XXXXXXXXXXXX:role/LambdaRole\u0026#34;,\r\u0026#34;Handler\u0026#34;: \u0026#34;devlounge.lambda.FindAllTripsHandler\u0026#34;,\r\u0026#34;CodeSize\u0026#34;: 9737054,\r\u0026#34;Description\u0026#34;: \u0026#34;TravelBuddy TripSearch microservice - FindAllTrips\u0026#34;,\r\u0026#34;Timeout\u0026#34;: 15,\r\u0026#34;MemorySize\u0026#34;: 1024,\r\u0026#34;LastModified\u0026#34;: \u0026#34;2021-03-30T18:10:38.011+0000\u0026#34;,\r\u0026#34;CodeSha256\u0026#34;: \u0026#34;EGhfTqT/kThg05Ibn8ivLWcKSabLZtIh/t3brnmvyHA=\u0026#34;,\r\u0026#34;Version\u0026#34;: \u0026#34;$LATEST\u0026#34;,\r\u0026#34;TracingConfig\u0026#34;: {\r\u0026#34;Mode\u0026#34;: \u0026#34;PassThrough\u0026#34;\r},\r\u0026#34;RevisionId\u0026#34;: \u0026#34;4fdee380-f0ce-4e1e-ab1e-d42e74e89308\u0026#34;,\r\u0026#34;State\u0026#34;: \u0026#34;Active\u0026#34;,\r\u0026#34;LastUpdateStatus\u0026#34;: \u0026#34;Successful\u0026#34;,\r\u0026#34;PackageType\u0026#34;: \u0026#34;Zip\u0026#34;\r}\rTạo hai hàm Lambda mới sử dụng chung cá thành phần triển khai Mã triển khai chức năng TripSearch của chúng ta có ba handler được cung cấp - một để tìm tất cả các chuyến đi; một để tìm các chuyến đi bắt nguồn từ một thành phố nhất định; và một để tìm các chuyến đi có một thành phố nhất định làm điểm đến. Hiện tại, chúng ta mới chỉ tiếp xúc với một handler - tìm kiếm cho tất cả các chuyến đi. Trong phần này, chúng ta sẽ tạo hai hàm Lambda mới, mỗi hàm cung cấp một trong hai handler còn lại.\nTạo một hàm Lambda mới từ cùng một cấu phần triển khai mà chúng tôi đã tải lên trước đó. Chúng ta có thể tạo các hàm Lambda khác nhau từ cùng một thành phần vì tạo tác xuất ra nhiều Lambda handler. Ở bước trên, chúng tôi đã cung cấp devlounge.lambda.FindAllTripsHandler. Trong bước này, chúng ta sẽ cung cấp devlounge.lambda.FindTripsFromCityHandler. CHúng ta có thể chạy lại các lệnh phía trên nhưng thay đổi handler nên bạn có thể đặt một tên riêng cố định.  Thực hiện câu lệnh sau khi cập nhật các thông số thay đổi từ Cloud Formation:\naws lambda create-function --function-name idevelopTripSearchFromCity --runtime java8 --role \u0026lt;LambdaRole\u0026gt; --handler devlounge.lambda.FindTripsFromCityHandler --code S3Bucket=\u0026lt;S3BucketLambdaCode\u0026gt;,S3Key=tripsearch-1.0.0.jar --timeout 15 --description \u0026#34;TravelBuddy TripSearch microservice - FindTripsFromCity\u0026#34; --memory-size 1024 --region ap-northeast-1\rThay giá trị trong Cloudformation Outputs bằng giá trị của S3BucketLambdaCodeBucketName. Thay giá trị trong Cloudformation Outputs thay cho khóa LambdaRoleARN.\nChắc chắn rằng bạn sẽ được nhận các phản hồi thành công tương tự với việc bạn đã tạo hàm Lambda đầu tiên:\nTạo hàm Lambda cuối cùng với cùng thành phần triển khai, lần này là cho FindTripsToCity. Cũng như các bước trên, lần này chúng ta sẽ cung cấp devlounge.lambda.FindTripsToCityHandler.  Thực hiện câu lệnh sau khi cập nhật các thông số thay đổi từ Cloud Formation:\naws lambda create-function --function-name idevelopFindTripsToCity --runtime java8 --role \u0026lt;LambdaRole\u0026gt; --handler devlounge.lambda.FindTripsToCityHandler --code S3Bucket=\u0026lt;S3BucketLambdaCode\u0026gt;,S3Key=tripsearch-1.0.0.jar --timeout 15 --description \u0026#34;TravelBuddy TripSearch microservice - FindTripsToCity\u0026#34; --memory-size 1024 --region ap-northeast-1\rThay giá trị trong Cloudformation Outputs bằng giá trị của S3BucketLambdaCodeBucketName. Thay giá trị trong Cloudformation Outputs thay cho khóa LambdaRoleARN.\nChắc chắn rằng bạn sẽ được nhận các phản hồi thành công tương tự với việc bạn đã tạo hàm Lambda.\n"
},
{
	"uri": "/vi/3-aaa/2-microservice-authen/",
	"title": "Xác thực cho Microservice",
	"tags": [],
	"description": "",
	"content": "Thiết lập Xác thực cho Microservice\nNgay bây giờ, nếu bạn nhấp vào nút **Go!**trên trang web và không nhập thành phố để lọc, bạn sẽ thấy một hộp thoại với tất cả các chuyến đi có sẵn. Chúng ta muốn thay đổi hành vi này để bạn phải đăng nhập để có thể tìm kiếm tất cả các chuyến đi mà không cần bộ lọc. Đây chỉ là một ví dụ để chứng minh cách chúng ta có thể giới hạn các lệnh gọi API nhất định cho chỉ những người dùng được xác thực.\nContents\n Cập nhật AWS API Gateway Tạo một Authorizer sử dụng Cognito User Pool Mở yêu cầu xác thực cho microservice /trips  Cập nhật AWS API Gateway  Truy cập AWS API Gateway console, chọn liên kết Gateway Responses ở mục liên kết iDevelop - Trip Search API link. Trong bảng Gateway Responses, kéo xuống và chọn Unauthorized (401) để mở thiết lập. Chọn Edit Để ứng dụng web của chúng ta có thể nhận được trạng thái unauthorized 401, chúng ta cần thêm CORS headers vào phản hồi. Nếu không có header, trình duyệt sẽ không có quyền nhận trạng thái 401. Chúng ta đã bật CORS cho phản hồi trạng thái 200 khi chúng ta thiết lập các API Gateway endpoint trước đó. Nhưng chúng ta cần cho phép trả lại trạng thái 401 một cách rõ ràng.  Trong phần Response Headers, thêm hai cặp header/giá trị sau:\n   Tên Header \u0026lsquo;static value\u0026rsquo;     Access-Control-Allow-Origin \u0026lsquo;*\u0026rsquo;   Access-Control-Allow-Headers \u0026lsquo;*\u0026rsquo;    Bạn phải thêm các dấu nháy đơn xung quanh giá trị tĩnh như được hiển thị ở trên. Không thêm * bởi chính nó, hãy bao quanh nó bằng các dấu ngoặc kép như được hiển thị. Đảm bảo rằng không có khoảng trắng sau tên tiêu đề nếu bạn sao chép/dán từ các cloudformation của bài thực hành.\n\rChọn nút Save trong bảng 401 để lưu thiết lập.  Tạo một Authorizer sử dụng Cognito User Pool API Gateway tích hợp chặt chẽ với Cognito cho xác thực. Bạn chỉ cần khai báo Cognito User Pool là một authorizer cho API của bạn.\nChọn liên kết Authorizers ở trong liên kết iDevelop - Trip Search API trong thanh điều hướng Chọn Create New Authorizer Ở Name nhập TravelBuddy Ở Type chọn Cognito Chọn giá trị TravelBuddy từ danh sách Cognito User Pool bằng cách chọn vào giá trị hiển thị Ở Token Source nhập Authorization và chú ý đánh vần cũng như các chữ viết hoa chính xác. Chọn Create  Mở yêu cầu xác thực cho microservice /trips Chọn Resources ở trong liên kết iDevelop - Trip Search API trong thanh điều hướng Chọn method GET trong /trips Chọn Method Request Chọn biểu tượng bút chì ở cạnh mục Authorization từ menu hiển thị, chọn TravelBuddy. Đây là authoriser mà chúng ta đã tạo ở bước trước và liên kết đến Cognito User Pool chúng ta đang sử dụng cho cơ sở dữ liệu người dùng. Nếu nó không xuất hiện, hãy thử làm mới trình duyệt của bạn.  Chọn dấu tick xám ở cạnh giá trị để lưu thiết lập.  "
},
{
	"uri": "/vi/2-spa/",
	"title": "Ứng dụng Đơn trang (SPA)",
	"tags": [],
	"description": "",
	"content": "Tạo một Ứng dụng Đơn trang (SPA)\nTrong bài thực hành này, bạn sẽ tạo một Ứng dụng Đơn trang (SPA) cho TravelBuddy. Một ứng dụng đơn trang là một ứng dụng web hoặc trang web tương tác với người dùng thông qua việc tự động viết lại trang hiện tại bằng các dữ liệu mới nhận được từ máy chủ web thay vì thực hiện tải một trang hoàn toàn mới theo cách thông thường. SPA sẽ tương tác thông qua một tập các API cung cấp bởi API Gateway.\nNội dung\n Cài đặt \u0026amp; Cấu hình chuẩn bị Xây dựng và Triển khai Serverless Microservice thủ công Tạo và Cung cấp API với Amazon API Gateway Triển khai API sử dụng CodeStar và CI/CD Thiết lập một Ứng dụng Đơn trang Xây dựng Client để sử dụng API  "
},
{
	"uri": "/vi/1-prerequisites/1-create-environment/2-ec2/",
	"title": "EC2",
	"tags": [],
	"description": "",
	"content": "EC2 CloudFormation cũng tạo một Workspace instance.\n Truy cập vào bảng điều khiển EC2 Chọn Instances, bạn sẽ thấy một EC2 instance đã được tạo sẵn  Nếu bạn không thấy bất kỳ instance nào trong danh sách, vui lòng kiểm tra bảng điều khiển AWS CloudFormation. Các mod-xxxxxx stack status, phải là CREATE_COMPLETE trước khi một EC2 instance chạy\n\rChọn tab Security, bạn sẽ thấy security group được gắn với máy ảo.  Chọn mở rộng tab Inbound rules bạn sẽ thấy các giao thức cũng như địa chỉ IP nguồn được phép truy cập từ những port này.  Trong bài thực hành này, CloudFormation template tạo các quy tắc bảo mật cho phép tất cả các địa chỉ IP nguồn được phép kết nối tới. Bạn có thể chỉnh sửa và chỉ cho phép kết nối tới từ địa chỉ IP của bạn.\nChọn tab Volumes, bạn sẽ thấy một EBS volume.  "
},
{
	"uri": "/vi/1-prerequisites/2-remote-env-config-cli/",
	"title": "Truy cập từ xa vào máy ảo Windows và cấu hình AWS CLI",
	"tags": [],
	"description": "",
	"content": "Truy cập từ xa vào máy ảo Windows  Truy cập vào AWS EC2 và vào máy ảo DexAxWindowsHost Chọn Connect  Chọn tab RDP client  Chọn Getpassword để lấy mật khẩu đăng nhập vào máy ảo Chọn Browse và trỏ tới tập tin keypair đã lưu ở phần 1. Chọn Decrypt Password  Sao chép mật khẩu và chọn Download remote desktop file. Một file RDP sẽ được tải xuống, dùng để truy cập vào máy ảo Windows  Mở file RDP đã tải, nhập mật khẩu đã lưu ở bước 6 và chọn Connect. Một cảnh báo về xác minh chứng chỉ có thể xuất hiện, chọn Continue để tiếp tục.\nNhư vậy, ta đã kết nối được vào máy ảo Windows được tạo.  Cấu hình AWS CLI Mở và nhập đoạn sau vào trình soạn thảo  aws configure set profile.devaxacademy.region \u0026lt;your_region\u0026gt;\raws configure set profile.devaxacademy.aws_access_key_id \u0026lt;access_key_id\u0026gt;\raws configure set profile.devaxacademy.aws_secret_access_key \u0026lt;secret_access_key\u0026gt;\rNếu bạn đã có một bộ thông tin xác thực cho người dùng IAM có đặc quyền quản trị, bạn có thể sử dụng lại chúng cho các thông tin bên dưới trong bước tiếp theo. Nếu bạn chưa có thông tin xác thực truy cập, làm theo hướng dẫn tại đây để truy xuất chúng cho người dùng có đặc quyền quản trị để sử dụng trong bài thực hành này. Điền các giá trị của người dùng IAM vào câu lệnh aws configure:  \u0026lt;your_region\u0026gt; với Region code \u0026lt;access_key_id\u0026gt; với giá trị Access Key Id \u0026lt;secret_access_key\u0026gt; với giá trị Secret Access Key   Sao chép và dán đoạn code vào comand line và thực thi chúng  "
},
{
	"uri": "/vi/3-aaa/",
	"title": "Cấu hình AAA",
	"tags": [],
	"description": "",
	"content": "Cấu hình Authentication, Authorization và Accounting (AAA)\nHiện tại, TravelBuddy SPA của chúng ta không yêu cầu bất kỳ xác thực nào để gọi các dịch vụ API mà chúng ta đã cung cấp. Quá trình thiết lập bài thực hành đã cung cấp Cognito User Pool và một Cognito Identity Pool trong tài khoản của bạn. Cognito User Pool là hệ thống hồ sơ được quản lý hoàn toàn về người dùng trong ứng dụng của bạn. Identity Pool được sử dụng để lấy thông tin đăng nhập AWS IAM tạm thời để ký các yêu cầu yêu cầu SigV4 signing. Cognito Identity Pool liên kết giữa nhiều Identity Providers, nhưng trong ví dụ thực hành của chúng ta, chúng ta chỉ có một Identity Provider (User Pool). TravelBuddy SPA của chúng ta thực tế không có yêu cầu về thông tin xác thực IAM, nhưng chúng ta đã triển khai tính năng này để chứng minh cách bạn có thể thực hiện điều này. Trong một Bài tập thử thách, chúng ta sẽ yêu cầu bạn triển khai AWS IAM Authorization cho việc gọi vào API Gateway, nhưng đây là một nhiệm vụ khong bắt buộc đối với bài thực hành.\nNội dung  Thêm Xác thực vào SPA sử dụng Amazon Cognito User Pools Thiết lập Xác thực cho Microservice Triển khai và Kiểm thử Hành động mới Thêm Đăng ký và Đăng nhập Người dùng  "
},
{
	"uri": "/vi/3-aaa/3-deploy-test/",
	"title": "Triển khai và Kiểm thử",
	"tags": [],
	"description": "",
	"content": "Triển khai và Kiểm thử Hành động mới\n Bạn phải triển khai lại API để các thay đổi có hiệu lực trên API của bạn. Từ menu Actions , chọn Deploy API. Triển khai API cho stage prod . Chuyển sang trang TravelBuddy SPA, và làm mới nó. Không nhập giá trị đích đến, nhấp vào Go!. Sau một lúc, bạn sẽ thấy một bong bóng hiện lên và thông báo bạn cần đăng nhập để có thể sử dụng tính năng.  "
},
{
	"uri": "/vi/2-spa/3-api-gateway/",
	"title": "Tạo và Cung cấp API",
	"tags": [],
	"description": "",
	"content": "Tạo và Cung cấp API với Amazon API Gateway\nHiện tại, bạn đã tạo xong các hàm Lambda, đã đến lúc tạo và triển khai thủ công API Gateway sẽ cung cấp microservice dưới dạng API.\nNội dung\n Cung cấp /tripsfromcity RESTful API endpoint Cung cấp /tripstocity RESTful API endpoint Triển khai API và Kiểm thử Exercise 2 - Use CloudFormation/SAM via the AWS CLI to deploy the HotelSearch microservice Kiểm thử HotelSpecials API   Truy cập AWS API Gateway console thông qua menu Services và tìm api trong thanh tìm kiếm. Nhấn Enter. Chọn Get Started nếu xuất hiện. Đi đến Create REST API và chọn Build. Chắc rằng bạn không chọn lựa chọn có từ \u0026ldquo;Private\u0026quot;.  Ở màn hình kế tiếp, chọn OK. Chắc rằng bạn lựa chọn New API :  Ở API Name nhập iDevelop - Trip Search API Ở Description nhập Allows searching ở trips from/to cities Chọn Create API.  API sẽ được tạo và chỉ có đường dẫn root. Chọn vào đường dẫn gốc / và chọn Actions để xem menu. Chọn Create Resource.  Trong New Child Resource, ở Resource Name nhập trips Ở Resource Path nhập trips Đánh dấu vào Enable API Gateway CORS Chọn Create Resource  Resource /trips sẽ được tạo. Chọn vào đường dẫn /trips, sau đó chọn Actions và chọn Create Method.  Trong danh sách liệt kê xuất hiện, chọn GET  Chọn dấu tick bên cạnh để xác nhận lưu thiết lập. Bảng /trips - GET - Setup sẽ xuất hiện. Ở Lambda Region chọn ap-northeast-1 (hoặc region của bạn) Ở Lambda Function, nhập idevelop để thấy các hàm đang có trong region và chọn idevelopTripSearchFull.  Chọn Save. Trong hộp thoại xuất hiện sau khi phần quyền cho Lambda, chọn OK. Khi method được tạo, bạn sẽ thấy bảng Method Execution:  Để kiểm tra hàm Lambda được gọi bởi API, chọn nút Test.\nTrong bảng Method Test, kéo xuống để thấy nút Test.  Chọn nút Test. Sau một vài phút để hàm Lambda khởi chạy và thực thi, bạn sẽ thấy kết quả tương tự như sau:  Lưu ý rằng dữ liệu bạn thấy sẽ khác vì nó được tạo ngẫu nhiên bởi quá trình thiết lập bài thực hành.\n\rĐể cho phép truy cập từ trình duyệt, bạn cần bật CORS - Cross-origin scripting. Chọn vào /trips và từ menu Actions, chọn Enable CORS. Chọn Enable CORS and replace existing CORS headers. Trong hộp thoại xuất hiện, chọn Yes, replace existing values. Khi các mục liệt kê có dấu tick xanh, bạn có thể tiếp tục các bước kế. Sẽ mất một ít thời gian để hoàn thành.  Cung cấp /tripsfromcity RESTful API endpoint Đường dẫn đầu tiên mà chúng ta cung cấp khá đơn giản - /trips sẽ lấy tất cả các chuyến đi trong hệ thống.\nNhưng chúng ta biết việc triển khai mã nguồn của chúng ta cho phép chúng ta chỉ định một bộ lọc để truy vấn ở các chuyến đi xuất phát từ một thành phố cụ thể hoặc có điểm đến cụ thể. Vì vậy chúng ta muốn hiển thị chức năng này cho người dùng API của mình. Đầu tiên, chúng ta sẽ hiển thị đường dẫn /tripfromcity.\nChọn vàp / trong cây Resources Từ menu Actions chọn Create Resource Ở Resource Name nhập tripsfromcity Chọn vào Enable API Gateway CORS Chọn Create Resource Lệnh gọi của chúng ta vào hàm Lambda yêu cầu thông số city. Chúng ta sẽ đi theo tiêu chuẩn ở RESTful interface và chuyển tham số này vào dưới dạng tham số truyền trên URL. Chọn vào /tripsfromcity, từ menu Actions, chọn Create Resource Ở Resource Name nhập {city} Ở Resource Path, xóa nội dung mặc định và nhập {city} Chọn Create Resource Chọn vào /{city}, từ menu Actions, chọn Create Method Trong danh sách liệt kê, chọn GET Chọn dấu tick xám bên cạnh để xác nhận lưu thiết lập. Bảng /tripsfromcity/{city} - GET - Setup sẽ xuất hiện. Ở Lambda Region chọn ap-northeast-1 (hoặc region của bạn) Ở Lambda Function, nhập idevelop để thấy các hàm đang có trong region và chọn idevelopTripSearchFromCity Chọn Save Trong hộp thoại xuất hiện sau khi phần quyền cho Lambda, chọn OK. Khi method được tạo, bạn sẽ thấy bảng Method Execution như bước trước tạo resource /trips. Chúng ta không thể tiếp tục thực hiện kiểm thử gọi đến API bởi vì chúng ta cần biến đổi yêu cầu thông qua API Gateway nhằm lấy được thông tin {city} được truyền qua hàm Lambda chính xác.  devlounge.lambda.FindTripsFromCityHandler handler cần thấy được thông số truyền vào từ yêu cầu như sau:\n{\r\u0026#34;payload\u0026#34; : {\r\u0026#34;city\u0026#34;: \u0026#34;Melbourne\u0026#34;\r}\r}\r\rĐiều này sẽ khiến hàm Lambda tìm kiếm DynamoDB ở tất cả các chuyến đi xuất phát từ Melbourne. Chúng ta cần thêm một Body Mapping Template cho method này ở API Gateway nhằm chuyển đổi thông số cho đúng theo yêu cầu.\n\rTrong bảng /tripsfromcity/{city} - GET - Method Execution, chọn Integration Request Kéo xuống Mapping Templates và mở rộng mục bằng cách chọn vào dấu tam giác. Chọn lựa chọn When there are no templates defined (recommended) Chọn Add mapping template Ở Content-Type nhập application/json và chọn dấu tick xám để lưu lựa chọn Kéo xuống nữa để thấy khung nhập liệu. Nhập vào template sau:  {\r\u0026#34;payload\u0026#34; : {\r\u0026#34;city\u0026#34;: \u0026#34;$input.params(\u0026#39;city\u0026#39;)\u0026#34;\r}\r}\rChọn Save.  Template này sẽ lấy tham số {city} từ URL và thêm nó vào JSON payload và gửi đến hàm Lambda giống như hàm Lambda mong đợi.\nSchema được định nghĩa ở đây cho hàm Lambda này là hoàn toàn có thể tùy chỉnh và trong ứng dụng của bạn, bạn có thể sử dụng một mô hình hoàn toàn khác. Mẫu ánh xạ cung cấp cho bạn sự linh hoạt để chuyển đổi dữ liệu đến một cách nhanh chóng thông qua API Gateway endpoint.\n\rBây giờ chúng ta đã có thể kiểm thử. Chọn Method Execution và quay về bảng Method Execution. Chọn Test để hiện bảng Test. Ở mục Path, ở thông số {city}, nhập Melbourne Chọn Test.  API Gateway sẽ thực hiện lệnh gọi vào hàm Lambda, truyền giá trị Melbourne vào Body Mapping Template mà bạn đã xác định, chèn tham số tìm kiếm Melbourne vào JSON payload được gửi đến hàm Lambda. Điều này sẽ khiến handler sử dụng JSON và thực hiện tìm kiếm trong bảng DynamoDB và trả về kết quả. Bạn sẽ thấy một kết quả tương tự như sau:\nĐể cho phép truy cập từ trình duyệt, bạn cần bật CORS - Cross-origin scripting. Chọn vào /tripsfromcity/{city} và từ menu Actions, chọn Enable CORS. Chọn Enable CORS and replace existing CORS headers. Trong hộp thoại xuất hiện, chọn Yes, replace existing values. Khi các mục liệt kê có dấu tick xanh, bạn có thể tiếp tục các bước kế. Sẽ mất một ít thời gian để hoàn thành.  Cung cấp /tripstocity RESTful API endpoint Kế đến, chúng ta sẽ cung cấp Resource cuối cùng - Trips API, /tripstocity:\nChọn vàp / trong cây Resources Từ menu Actions chọn Create Resource Ở Resource Name nhập tripstocity Chọn vào Enable API Gateway CORS Chọn Create Resource Lệnh gọi của chúng ta vào hàm Lambda yêu cầu thông số city. Chúng ta sẽ đi theo tiêu chuẩn ở RESTful interface và chuyển tham số này vào dưới dạng tham số truyền trên URL. Chọn vào /tripstocity, từ menu Actions, chọn Create Resource Ở Resource Name nhập {city} Ở Resource Path, xóa nội dung mặc định và nhập {city} Check the Enable API Gateway CORS checkbox Chọn Create Resource Chọn vào /{city}, từ menu Actions, chọn Create Method Trong danh sách liệt kê, chọn GET Chọn dấu tick xám bên cạnh để xác nhận lưu thiết lập. Bảng /tripstocity/{city} - GET - Setup sẽ xuất hiện. Ở Lambda Region chọn ap-northeast-1 (hoặc region của bạn) Ở Lambda Function, nhập idevelop để thấy các hàm đang có trong region và chọn idevelopTripSearchToCity Chọn Save Trong hộp thoại xuất hiện sau khi phần quyền cho Lambda, chọn OK. Khi method được tạo, bạn sẽ thấy bảng Method Execution như bước trước tạo resource /trips. Chúng ta không thể tiếp tục thực hiện kiểm thử gọi đến API bởi vì chúng ta cần biến đổi yêu cầu thông qua API Gateway nhằm lấy được thông tin {city} được truyền qua hàm Lambda chính xác.  devlounge.lambda.FindTripsToCityHandler handler cần thấy được thông số truyền vào từ yêu cầu như sau:\n{\r\u0026#34;payload\u0026#34; : {\r\u0026#34;city\u0026#34;: \u0026#34;Melbourne\u0026#34;\r}\r}\r\rĐiều này sẽ khiến hàm Lambda tìm kiếm DynamoDB ở tất cả các chuyến đi xuất phát từ Melbourne. Chúng ta cần thêm một Body Mapping Template cho method này ở API Gateway nhằm chuyển đổi thông số cho đúng theo yêu cầu.\n\rTrong bảng /tripstocity/{city} - GET - Method Execution, chọn Integration Request Kéo xuống Mapping Templates và mở rộng mục bằng cách chọn vào dấu tam giác. Chọn lựa chọn When there are no templates defined (recommended) Chọn Add mapping template Ở Content-Type nhập application/json và chọn dấu tick xám để lưu lựa chọn Kéo xuống nữa để thấy khung nhập liệu. Nhập vào template sau:  {\r\u0026#34;payload\u0026#34; : {\r\u0026#34;city\u0026#34;: \u0026#34;$input.params(\u0026#39;city\u0026#39;)\u0026#34;\r}\r}\rChọn Save  Template này sẽ lấy tham số {city} từ URL và thêm nó vào JSON payload và gửi đến hàm Lambda giống như hàm Lambda mong đợi.\nKiểm thử gọi đến API /tripstocity để chắc chắn nó đã hoạt động.  Để cho phép truy cập từ trình duyệt, bạn cần bật CORS - Cross-origin scripting. Chọn vào /tripstocity/{city} và từ menu Actions, chọn Enable CORS. Chọn Enable CORS and replace existing CORS headers Trong hộp thoại xuất hiện, chọn Yes, replace existing values. Khi các mục liệt kê có dấu tick xanh, bạn có thể tiếp tục các bước kế. Sẽ mất một ít thời gian để hoàn thành.  Nếu đã hoàn thành đến đây, bạn sẽ có một cây Resource nhìn tương tự như thế này:\nTriển khai API và Kiểm thử Bây giờ bạn chắc chắn rằng các microservices đang hoạt động bình thường, bạn đã sẵn sàng triển khai API và kiểm tra nó từ endpoint công khai. Chọn vàp / của API và chọn nút Actions. Chọn Deploy API  Trong hộp thoại Deploy API xuất hiện, ở Deployment stage chọn [New Stage] để tạo một stage mới. Ở Stage name nhập prod Ở Stage description nhập Trips API Ở Deployment description nhập Initial deployment Chọn Deploy  Stage mới tên prod sẽ được tạo và bạn sẽ thấy prod Stage Editor\nChọn đường dẫn Invoke URL. Một cửa sổ mới sẽ mở ra và truy cập đến địa chỉ đó. Bạn sẽ thấy một thông báo lỗi nêu rõ {\u0026quot;message\u0026quot;:\u0026quot;Missing Authentication Token\u0026quot;}. Điều này là do không có trình xử lý ở đường dẫn gốc của stage - bạn chỉ có các resources/methods được xác định bên dưới các đường dẫn /trips, /tripsfromcity và /tripstocity. Chỉnh sửa URL trong thanh URL của trình duyệt và thêm /trips rồi nhấn Enter. Trang sẽ làm mới và sau đó hiển thị tất cả các chuyến đi có sẵn dưới dạng JSON. Đầu ra sẽ tương tự như sau:  {\r\u0026#34;succeeded\u0026#34;: true,\r\u0026#34;message\u0026#34;: \u0026#34;\u0026#34;,\r\u0026#34;errorCode\u0026#34;: 0,\r\u0026#34;data\u0026#34;: [{\r\u0026#34;date\u0026#34;: 1511866019000,\r\u0026#34;originCity\u0026#34;: \u0026#34;Dallas\u0026#34;,\r\u0026#34;destinationCity\u0026#34;: \u0026#34;Santigo de Chile\u0026#34;,\r\u0026#34;airline\u0026#34;: \u0026#34;Qantas\u0026#34;\r}, {\r\u0026#34;date\u0026#34;: 1514831014000,\r\u0026#34;originCity\u0026#34;: \u0026#34;London\u0026#34;,\r\u0026#34;destinationCity\u0026#34;: \u0026#34;Melbourne\u0026#34;,\r\u0026#34;airline\u0026#34;: \u0026#34;Qantas\u0026#34;\r}]\r}\rKiểm tra hai cái method còn lại /tripsfromcity và /tripstocity theo cách tương tự, nhưng lần này, bạn cần cung cấp thành phố để tìm kiếm. Ví dụ, sử dụng /tripsfromcity/Melbourne để tìm kiếm tất cả các chuyến đi khởi hành từ Melbourne.  Nếu dữ liệu có vẻ đúng và không có lỗi, bạn đã sẵn sàng chuyển sang bài tập tiếp theo.\nExercise 2 - Use CloudFormation/SAM via the AWS CLI to deploy the HotelSearch microservice Trong các bước trước đó, bạn đã triển khai và cấu hình vi microservice TripSearch theo cách thủ công, bao gồm các hàm Lambda và API Gateway resource. Bạn sẽ nhận thấy rằng có khá nhiều bước cần làm và thực hiện việc này theo cách thủ công rất tốn thời gian và dễ xảy ra lỗi. Trong bước này, bạn sẽ sử dụng AWS CLI và CloudFormation/SAM để triển khai microservice HotelSearch, thay vì triển khai thủ công các tài nguyên.\nBằng cách sử dụng CloudFormation/SAM, nhiều bước thủ công sẽ được thực hiện cho bạn, sắp xếp quy trình triển khai. Bạn vẫn sẽ phải kích hoạt quy trình theo cách thủ công, nhưng việc triển khai thực tế sẽ được tự động hóa.\nHotelSpecials microservice cần truy cập vào cơ sở dữ liệu MySQL để truy xuất dữ liệu về các dữ liệu đặc biệt của khách sạn. Môi trường bài thực hành đã tự động triển khai và tạo cơ sở dữ liệu cho bạn và chi tiết kết nối được cung cấp trong CloudFormation Outputs với hướng dẫn bên dưới về nơi cập nhật các thông số trong template mà bạn sẽ sử dụng để triển khai microservice. Cơ sở dữ liệu MySQL đã được triển khai bằng Amazon RDS và không thể truy cập công khai vì nó được khởi chạy trong một mạng con riêng tư. Do đó, để hàm Lambda để có thể kết nối với cơ sở dữ liệu, hàm Lambda cũng sẽ cần được triển khai thành một mạng con riêng bằng cách kích hoạt VPC Integration. Tập tin template.yml được cung cấp có tất cả các thiết lập cần thiết để thực hiện việc này, bạn chỉ cần cập nhật các thông số theo hướng dẫn bên dưới.\nMôi trường bài thực hành đã tạo một S3 bucket cho bạn để lưu trữ phần mềm triển khai cho hàm Lambda ở microservice HotelSpecials. Đầu tiên, bạn cần kiểm tra và xây dựng gói triển khai.  Tải xuống gói mã nguồn từ HotelSpecials.zip và giải nén trên máy bạn.\n\r\rHotelSpecials source code bundle\r\r\rHotelSpecials.zip\r\r(35 ko)\r\r\r\rTrong cửa số lệnh, cd vào vị trí giải nén mã nguồn HotelSpecials và xây dựng các thành phần triển khai bằng lệnh sau:  mvn package shade:shade\rPhần mềm xây dựng xong (JAR file) sẽ được lưu tại ./target/hotelspecials-1.0.0.jar\nTìm tập tin template.yml trong thư mục mã nguồn HotelSpecials và mở nó trong trình soạn thảo văn bản như Eclipse. Tìm và thay thế các thông số sau với thông tin lấy từ CloudFormation Outputs:   \u0026lt;DatabaseSecurityGroup\u0026gt; \u0026lt;DatabaseSubnet1\u0026gt; \u0026lt;DatabaseSubnet2\u0026gt; \u0026lt;RDSEndpoint\u0026gt;  Lưu tập tin template.yml sau khi đã thay đổi.\nSử dụng AWS CLI để đóng gói hàm Lambda (từ thành phần triển khai bạn vừa tạo). Chạy lệnh sau từ cửa sổ dòng lệnh:  aws cloudformation package --template template.yml --s3-bucket \u0026lt;S3BucketLambdaCode\u0026gt; --output-template template-export.yml\r\rThay giá trị trong Cloudformation Outputs bằng giá trị của S3BucketLambdaCodeBucketName. Không thêm ký tự *\u0026lt;* và **\u0026gt;**.\n\rLệnh sẽ tải lên các artifact vào S3 bucket, sau đó cập nhật con trỏ template.yml thành artifact trên S3 và ghi ra một mẫu mới có kèm theo bản cập nhật này vào một tệp có tên template-export.yml.\nSẽ mất một hoặc hai phút để hoàn tất quá trình tải lên artifact.\n\rSử dụng AWS CLI để tạo và triển khai CloudFormation Change Set:  aws cloudformation deploy --template-file template-export.yml --stack-name HotelSpecialsAPI --capabilities CAPABILITY_IAM\rTrong web browser, mở CloudFormation console. Bạn sẽ thấy một kết quả như thế này:  Điều này cho thấy rằng CloudFormation Change Set đã được tạo. Lệnh bạn đã đưa ra sẽ tạo Change Set và sau đó tự động thực hiện Change Set, vì vậy nếu bạn làm mới lại stack, bạn sẽ thấy:\nĐiều này cho thấy rằng Change Set đang được áp dụng cho CloudFormation stack có tên HotelSpecialsAPI\nSẽ mất một vài phút để hoàn tất quá trình thực thi. Nếu bạn làm mới, cuối cùng bạn sẽ thấy:\n Chọn HotelSpecialsAPI stack để đánh dấu, chọn Events và xem lại các bước mà CloudFormation template đã áp dụng cho môi trường của bạn. Chúng sẽ khớp với các tài nguyên và hành động trong tập tin template-output.yml.\n  Khi Change Set đã được thực thi, HotelSpecials API của bạn đã được triển khai. Mở API Gateway console trong trình duyệt và trong APIs, chọn liên kết iDevelop - Hotel Specials API để hiển thị các tài nguyên trong API:\n  Lưu ý rằng một phương thức GET duy nhất được xác định, theo mẫu CloudFormation template template.yml mà bạn đã triển khai.\n\rChọn vào GET method ở /hotelspecials để thấy bảng /hotelspecials - GET - Method Execution. Chọn Integration Request  Bảng Integration Request sẽ xuất hiện. Lambda Function xác định rõ:  The specified value is not a Lambda function, but instead, is a Stage Variable that will be replaced at runtime by API Gateway. Therefore, in order for this API call to succeed, the Stage in API Gateway must have defined a value for the envHotelSpecials stage variable.\nGiá trị được chỉ định không phải là một hàm Lambda, mà thay vào đó, là một Stage Variable sẽ được thay thế trong thời gian chạy bằng API Gateway. Do đó, để lệnh gọi API này thành công, Stage trong API Gateway phải xác định một giá trị cho Stage Variable envHotelSpecials.\nChọn vào Stages bên dưới iDevelop - Hotel Specials API:\nChọn vào đường dẫn prod  Trong prod Stage Editor chọn Stage Variables  Lưu ý rằng một biến duy nhất được xác định - envHotelSpecials - tương quan với tên biến giai đoạn mà phương thức GET đã mong đợi. Giá trị của biến là GetHotelSpecials là tên của hàm Lambda mà mẫu được tạo bằng cách sử dụng tập tin JAR mà bạn đã tạo và tải lên trong quá trình đóng gói/triển khai.\n\rViệc sử dụng các biến giai đoạn cung cấp cho bạn mức độ chuyển hướng trong thời gian chạy và cả khi thiết kế các CloudFormation/SAM templates của bạn. Bạn có thể cập nhật giá trị của biến giai đoạn bất kỳ lúc nào mà không cần phải triển khai lại API.\nKiểm thử HotelSpecials API Bây giờ bạn đã sẵn sàng để kiểm tra HotelSpecials API.\nMở rộng prod trong Stages để xem cấu trúc. Chọn vào method GET Chọn vào Invoke URL trong bảng prod - GET - /hotelspecials. Sau một khoảng thời gian, hàm Lambda khởi tạo, bạn sẽ thấy kết quả JSON truy xuất dữ liệu từ cơ sở dữ liệu MySQL về từ hàm Lambda.  {\r\u0026#34;succeeded\u0026#34;: true,\r\u0026#34;message\u0026#34;: \u0026#34;\u0026#34;,\r\u0026#34;errorCode\u0026#34;: 0,\r\u0026#34;data\u0026#34;: [{\r\u0026#34;hotel\u0026#34;: \u0026#34;Sommerset Hotel\u0026#34;,\r\u0026#34;description\u0026#34;: \u0026#34;Minimum stay 3 nights\u0026#34;,\r\u0026#34;cost\u0026#34;: 474,\r\u0026#34;expiryDate\u0026#34;: 1504064184038,\r\u0026#34;location\u0026#34;: \u0026#34;Sydney\u0026#34;,\r\u0026#34;id\u0026#34;: 1\r}, {\r\u0026#34;hotel\u0026#34;: \u0026#34;Freedmom Apartments\u0026#34;,\r\u0026#34;description\u0026#34;: \u0026#34;Pets allowed!\u0026#34;,\r\u0026#34;cost\u0026#34;: 501,\r\u0026#34;expiryDate\u0026#34;: 1504068564781,\r\u0026#34;location\u0026#34;: \u0026#34;Sydney\u0026#34;,\r\u0026#34;id\u0026#34;: 2\r}]\r}\rNếu bạn thấy một kết quả JSON không có lỗi, bạn đã triển khai thành công một API và hỗ trợ hàm Lambda truy vấn cơ sở dữ liệu mySQL.\nChú ý rằng chúng nhanh hơn và dễ hơn việc triển khai thủ công như thế nào?\nĐó là sức mạnh của tự động hóa. Trong bài tập tiếp theo, chúng ta sẽ thực hiện bước này xa hơn, sử dụng phương pháp tiếp cận CI/CD pipeline (hiện đã phổ biến) để triển khai API tiếp theo của chúng ta.\n"
},
{
	"uri": "/vi/1-prerequisites/1-create-environment/3-rds/",
	"title": "RDS",
	"tags": [],
	"description": "",
	"content": "RDS Dịch vụ cơ sở dữ liệu quan hệ của Amazon (Amazon RDS) giúp dễ dàng thiết lập, vận hành và mở rộng quy mô cơ sở dữ liệu quan hệ trên đám mây. Nó cung cấp khả năng tiết kiệm chi phí và có thể thay đổi kích thước trong khi tự động hóa các tác vụ quản trị tốn thời gian như cung cấp phần cứng, thiết lập cơ sở dữ liệu, vá lỗi và sao lưu.\n Truy cập bảng điều khiển RDS Chọn Database Bạn sẽ thấy một database mới được tạo, chọn vào database này Database được tạo đã được cấu hình với các dịch vụ VPC, Security Groups,\u0026hellip;  "
},
{
	"uri": "/vi/4-xray/",
	"title": "Hiệu năng Ứng dụng",
	"tags": [],
	"description": "",
	"content": "Theo dõi Hiệu năng Ứng dụng với AWS X-Ray\nMỗi hàm Lambda TripSearch, HotelSpecials và FlightSpecials chứa các phụ thuộc cần thiết để hỗ trợ phát ra các sự kiện theo dõi tới AWS X-ray, để cho phép bạn dễ dàng theo dõi các cuộc gọi giữa các thành phần của hệ thống phân tán của bạn. Trong bài thực hành này, bạn sẽ bật tính năng và xem lại AWS X-Ray console.\n Trong AWS Lambda Console, chọn vào Lambda function idevelopTripSearchFull. Chọn Configuration và chọn bảng Monitoring and operations tools. Chọn nút Edit vầ kích hoạt Active tracing trong mục AWS X-Ray. Chọn Save.  Chuyển qua trang TravelBuddy SPA mà chúng ta đã host trên S3. Đăng nhập vào ứng dụng nếu chưa đăng nhập. Chọn Go! mà không nhập vào địa điểm, kích hoạt hàm Lambda idevelopTripSearchFull. Sẽ mất một vài giây để hoàn thành.  Sau khi hộp thoại hiển thị các bản ghi, quay lại AWS console, tìm X-ray trên thanh tìm kiếm. Chọn vào X-ray item trong danh sách ở AWS X-ray console. Trong trang AWS X-Ray, chọn Get started và chọn Cancel.  Chọn Service map ở bảng bên trái. Bạn sẽ thấy Service map tương tự như sau:  Bây giờ, đã có thể xem Service map trực tiếp từ Lambda console.\n\rChọn vào vòng tròn xanh đầu tiên thể hiện cho việc gọi vào hàm Lambda. Bảng \u0026ldquo;Details\u0026rdquo; sẽ xuất hiện hiển thị thông tin về thời gian phản hồi, phân bổ phản hồi và thời gian thực thi.  Chọn View Traces, ở dưới cùng bảng Service details. Trong Traces list Chọn đối tượng đầu tiên hiển thị Bảng Traces details sẽ xuất hiện. Bạn sẽ có thể thấy được timeline của nhiều hành động và thời gian thực thi chúng, ví dụ:  Tại đây, bạn có thể thấy rằng việc gọi đến đã diễn ra trong 5 sec, 1.3 sec cho việc scan trong bảng TravelBuddyTripSectors DynamoDB.\nBật tính năng theo dõi chủ động trên các hàm Lambda khác đã được tạo như một phần của bài thực hành này: idevelopTripSearchFull, idevelopTripSearchFromCity, idevelopTripSearchToCity và GetHotelSpecials. Bạn có thể thực hiện việc này theo cách thủ công bằng console. Tuy nhiên, lưu ý rằng hàm được tạo thông qua tự động hóa có tên bắt đầu bằng awscodestar sẽ bị ghi đè cấu hình nếu bạn triển khai lại mã.  Xem thêm Bài tập nâng cao\n"
},
{
	"uri": "/vi/2-spa/4-codestar-cicd/",
	"title": "Triển khai API với CodeStar và CI/CD",
	"tags": [],
	"description": "",
	"content": "Microservice tiếp theo mà chúng ta cần cho ứng dụng serverless TravelBuddy của mình là FlightSpecials API. Chúng ta đã xem FlightSpecials trước đây trong bài thực hành này, vì vậy nó sẽ quen thuộc với bạn. Nó hoạt động giống như HotelSpecials API ở chỗ nó phải được triển khai tích hợp với VPC để có thể kết nối với cơ sở dữ liệu MySQL để truy vấn dữ liệu. Thay vì đóng gói và triển khai microservice này theo cách thủ công, chúng ta sẽ sử dụng CodeStar để xây dựng CI/CD pipeline đầy đủ cho chúng ta, như chúng ta đã làm trong các bài thực hành trước đây. Vì vậy, vì bạn đã tạo đường ống CI / CD bằng AWS CodeStar một vài lần, nên chúng ta sẽ không cung cấp cho bạn hướng dẫn từng bước đầy đủ. Nếu bạn cần trợ giúp, hãy hỏi thêm chuyển gia cách hoàn thành các tác vụ cần thiết để tạo một dự án CodeStar mới và triển khai mã FlightSpecials trên ứng dụng mẫu do CodeStar cung cấp.\nTùy thuộc vào việc bạn chọn sử dụng Eclipse hay AWS Cloud9, hãy chọn hướng dẫn thực hành thích hợp bên dưới:\nNội dung\n Lựa chọn A: Sử dụng Eclipse Lựa chọn B: Sử dụng AWS Cloud9  "
},
{
	"uri": "/vi/3-aaa/4-signup-signin/",
	"title": "Đăng ký và Đăng nhập Người dùng",
	"tags": [],
	"description": "",
	"content": "Thêm Đăng ký và Đăng nhập Người dùng\nChúng tôi gần như có mọi thứ chúng tôi cần để đăng ký và đăng nhập với tư cách là người dùng. Hãy kiểm tra xem các danh tính được liên kết của Cognito đã được thiết lập chính xác hay chưa.\n Truy cập Amazon Cognito console và chọn Manage Identity Pools Truy cập TravelBuddy identity pool và chọn vòa tiêu đề của nó. Chọn Edit identity pool ở góc phải  Tại đây chúng ta có thể thiết lập Unauthenticated roles (roles xác định khi người dùng không đăng nhập), và Authenticated roles (roles xác định khi người dùng đăng nhập).\nXác minh rằng Unauthenticated role được thiết lập chứa chuỗi CognitoIAMUnauthenticatedRole. Thông tin này được thiết lập khi tạo bài thực hành. Xác minh rằng Authenticated role được thiết lập chứa chuỗi CognitoIAMAuthenticatedRole. Thông tin này được thiết lập khi tạo bài thực hành.  Giờ đây, bạn đã có mọi thứ để đăng ký và đăng nhập với tư cách người dùng, sau đó kiểm tra hành vi đăng nhập của microservice /trips bây giờ rằng nó được bảo vệ bằng cách yêu cầu ủy quyền.\nTrong trang TravelBuddy , chọn Login or Register ở thanh điều hướng Chọn Sign-up here! Nhập thông tin đăng nhập của bạn  Lưu ý rằng bạn phải cung cấp địa chỉ email hợp lệ - địa chỉ mà bạn có quyền truy cập ngay lập tức, để bạn sẽ được gửi một mã xác minh.\n\rKiểm tra email của bạn, tìm mã xác minh và nhập mã đó vào khung Registration Verification Code. Chọn Verify.  Đăng nhập bằng thông tin đăng nhập (địa chỉ email và mật khẩu) bạn đã cung cấp trong quá trình đăng ký.  Bây giờ bạn sẽ đăng nhập và biểu ngữ sẽ thay đổi để hiển thị My Account. Nhấp vào liên kết - tính năng duy nhất được triển khai là tùy chọn Đăng xuất.  Bạn có thể đăng xuất và sau đó đăng nhập lại theo nếu bạn muốn thử.\n\rBây giờ bạn đã đăng nhập, hãy nhấp vào Go! một lần nữa mà không có bất kỳ nội dung nào được nhập.  Lưu ý rằng bạn sẽ được hiển thị danh sách chuyến đi đầy đủ trong một hộp thoại, như trước khi chúng ta khai báo bảo mật.\n\rBây giờ, hãy đăng xuất bằng cách sử dụng liên kết trong menu My Account và thử nhấn nút **Go!**lần nữa.\nLưu ý rằng bạn lại thấy thông báo lỗi, cho biết rằng bạn phải đăng nhập để sử dụng microservice /trips.\n\r"
},
{
	"uri": "/vi/5-challenge/",
	"title": "Bài tập nâng cao",
	"tags": [],
	"description": "",
	"content": "Là một nhiệm vụ tùy chọn, bạn được thử thách với việc triển khai theo dõi chủ động bằng cách sử dụng tự động hóa cho các chức năng được triển khai bằng AWS CLI và CodeStar. Chúng tôi sẽ không cung cấp cho bạn tất cả các câu trả lời! Nhưng để giúp bạn trong hành trình của mình, hãy xem AWS::Lambda::Function tài liệu CloudFormation, và tài liệu AWS SAM.\nKhi bạn đã triển khai đầy đủ theo dõi các hàm Lambda, bạn sẽ thấy các phân đoạn theo dõi trên AWS X-ray console. Kích hoạt thực thi các hàm lambda khác nhau bằng cách sử dụng trang web TravelBuddy SPA và bạn sẽ thấy các kết quả như:\n"
},
{
	"uri": "/vi/2-spa/5-setup-spa/",
	"title": "Thiết lập trang SPA",
	"tags": [],
	"description": "",
	"content": "Thiết lập Ứng dụng Đơn trang\nBây giờ chúng ta đã thiết lập ba API, chúng ta đã sẵn sàng gọi chúng từ trang web. Trước tiên, chúng ta cần thiết lập ứng dụng web đơn trang (SPA) và host nó trên Amazon S3.\nChúng ta đã quyết định sử dụng AngularJS framework cho SPA của mình. Tất nhiên bạn có thể sử dụng bất kỳ framework nào mà bạn cảm thấy phù hợp. Mục đích của bài thực hành này không phải để dạy bạn AngularJS hoặc bất kỳ framework SPA nào khác, vì vậy chúng ta sẽ không đi sâu vào chi tiết về cách hoạt động của trang, ngoài việc hướng dẫn bạn cách kết nối các lệnh gọi API mà SPA sẽ cần thực hiện để điền các phần tử dữ liệu của nó.\nNội dung\n Tạo client SDK cho từng API trong số ba API và triển khai tới SPA Đẩy các tập tin SPA lên Amazon S3   Tải xuống gói mã nguồn từ www.zip và giải nén trên môi trường làm việc của bạn.  \r\rMã nguồn ứng dụng\r\r\rwww.zip\r\r(5660 ko)\r\r\r\rTạo client SDK cho từng API trong số ba API và triển khai tới SPA Việc triển khai SPA mà bạn được cung cấp đã triển khai sơ bộ ba API mà chúng ta muốn cung cấp cho người dùng của mình. Họ có triển khai vừa đủ để không gây ra lỗi trên trang khi được thực thi, nhưng họ không cung cấp bất kỳ dữ liệu nào. Để \u0026lsquo;kết nối\u0026rsquo; các API của chúng ta với SPA, chúng ta sẽ cần tạo các Javascript client SDK có liên quan đến các API này và lưu trữ chúng trong đường dẫn thích hợp.\nĐối với từng API mà chúng ta đã tạo, hãy làm theo các hướng dẫn sau, sử dụng tên TripSearch, HotelSpecials hoặc FlightSpecials cho phù hợp:\nTruy cập vào API Gateway console và ở mục APIs, chọn iDevelop - Flight Specials API để xem các Resource của API. Chọn Stages Chọn prod Chọn SDK Generation Ở Platform, chọn Javascript Chọn Generate SDK. Javascript SDK cho API sẽ được tải về từ trình duyệt của bạn. Giải nén tập tin ZIP và tìm tới tập tin apigClient.js Đổi tên tập tin thành apigClient_FlightSpecials.js Mở tập tin đã đổi tên trong Eclipse/Cloud9 IDE. Chỉnh sửa nó dưới dạng tập tin văn bản - chỉ cần kéo nó vào IDE hoặc mở tập tin bằng menu. Dùng Search/Replace và thay hết các nội dung apigClientFactory bằng apigClientFactory_FlightSpecials. Sẽ có 2 lần xuất hiện để thay thế, cả hai lần xuất hiện ở đầu tập tin. Lưu tập tin Sao chép tập tin từ vị trí hiện tại sang thư mục api trong thư mục www của ứng dụng đơn trang trong môi trường làm việc của bạn. Thay thế bằng tập tin mà bạn lấy từ tập tin zip.  Lặp lại hướng dẫn ở trên hai lần - cho cả TripSearch và HotelSpecials API, hãy đảm bảo là tập tin apigClient.js từ các SDK tải về đổi thành apigClient_HotelSpecials.js và apigClient_TripSearch.js tương ứng, và bạn cần dùng search/replace nội dung apigClientFactory và thay bằng apigClientFactory_HotelSpecials và apigClientFactory_TripSearch tương ứng.\n\rĐẩy các tập tin SPA lên Amazon S3 Với các API SDK đã có, giờ đây bạn đã sẵn sàng triển khai mã nguồn SPA lên Amazon S3 Bucket đê trang web hoạt động. Quá trình thiết lập bài thực hành đã cung cấp một S3 bucket phù hợp, đã được kích hoạt WebSite Hosting. Vì vậy, bạn sẽ chỉ cần đẩy tất cả các tập tin từ máy của bạn sang S3 bucket để có thể kiểm tra ứng dụng.\nTrong cửa sổ lệnh, cd vào thư mục chứa mã nguồn của trang web SPA của bạn. Đưa ra lệnh sau để đồng bộ hóa giữa máy cục bộ của bạn và S3 bucket. Đảm bảo thay thế \u0026lt;S3BucketWWW\u0026gt; bằng giá trị được chỉ định trong Cloudformation Outputs:  aws s3 sync . s3://\u0026lt;S3BucketWWW\u0026gt; --acl public-read\rKhi quá trình đồng bộ hóa hoàn tất, bạn đã sẵn sàng để kiểm tra SPA của mình được lưu trữ trên S3. Mở URL sau trong trình duyệt web, thay thế tên của nhóm S3 bằng giá trị được hiển thị trong Cloudformation Outputs  S3BucketWWW :  http://\u0026lt;S3BucketWWW\u0026gt;.s3-website-ap-southeast-2.amazonaws.com\rTrang web TravelBuddy quen thuộc sẽ hiển thị trong trình duyệt của bạn. Trước đây, bạn đã từng thấy trang web này khi nó là một ứng dụng Java monolithic được cài đặt lên EC2 do Elastic Beanstalk quản lý. Nhưng bây giờ, trang web là một ứng dụng web một trang và được lưu trữ trong S3 bucket thực hiện các lệnh gọi API đến Amazon API Gateway để cung cấp dữ liệu cho trang web.\nBạn sẽ thấy danh sách Hotel Specials và Flight Specials được hiển thị trên trang.\nNgoài ra, tùy chọn Find trips to\u0026hellip; có sẵn. Để kiểm tra điều này, hãy nhập Melbourne vào trường văn bản và nhấp vào nút Go!. Một hộp thoại sẽ xuất hiện hiển thị kết quả tìm kiếm. Dữ liệu này đang được cung cấp từ việc gọi đến TripSearchAPI, ở đường dẫn /tripsfromcity.\nNếu bạn xóa giá trị trong trường và nhấp vào nút Go!, bạn sẽ thấy danh sách tất cả các chuyến đi có sẵn, được phục vụ từ lệnh gọi TripSearchAPI đến /trips.\nNếu bạn không thấy dữ liệu là kết quả của các lệnh gọi API, hãy xem developer console trong trình duyệt để xem liệu có bất kỳ lỗi nào giúp tìm ra sự cố hay không.\n"
},
{
	"uri": "/vi/2-spa/6-consume-api/",
	"title": "Sử dụng API",
	"tags": [],
	"description": "",
	"content": "Tạo một Client để sử dụng API\nBây giờ bạn có một mô hình hoạt động của trang web đang chạy như một SPA gọi dữ liệu thông qua RESTful API được lưu trữ trên AWS Lambda và cung cấp từ Amazon API Gateway. Các nguồn cấp dữ liệu này được coi là công khai vì người dùng không cần đăng nhập và cung cấp thông tin đăng nhập cho lệnh gọi tới API. Trong bài tập này, bạn sẽ xem xét cách bạn có thể yêu cầu xác thực để thực hiện lệnh gọi API và việc sử dụng Khóa API để thực thi điều chỉnh tốc độ cuộc gọi và quản lý hạn ngạch. Để chứng minh, bạn sẽ sử dụng một ứng dụng Java client, để chỉ ra cách bạn có thể sử dụng các Java SDK được tạo tự động trong các ứng dụng của bạn.\nNội dung\n Tạo Response Model cho TripSearch API Gán TripsFromCityResponse model cho API /tripsfromcity Tạo một ứng dụng client Java sử dụng API Tái tạo client SDK và cài đặt trên máy development Kiểm thử SDK vừa tạo mới với Ứng dụng Client Java Thiết lập API key trong mã nguồn Client và chạy lại Ứng dụng sử dụng API với tính năng throttling  Tạo Response Model cho TripSearch API In order for the SDK generator to create the appropriate classes for a strongly-typed language like Java (as opposed to Javascript, for example) we need to tell API Gateway what the shape or schema of the request/response objects looks like. In the TripSearch API, we are using the GET method for each of the three API calls. Therefore, there is no schema for inbound requests because the city parameter is passed on as part of the URL. If we instead changed the method to POST, we would need to pass in the city parameter in the body payload, and would need to create a model for this object schema for the code generator to create a Java class for us to bind to.\nĐể trình tạo SDK có thể tạo các lớp thích hợp cho một ngôn ngữ mạnh như Java (đối lập với Javascript), chúng ta cần cho API Gateway biết hình dạng hoặc schema của các đối tượng yêu cầu/phản hồi trông như thế nào. Trong TripSearch API, bạn đang sử dụng phương thức GET cho mỗi lệnh gọi API. Do đó, không có schema nào cho các yêu cầu gửi đến vì tham số city được truyền như một phần của URL. Thay vào đó, nếu bạn thay đổi phương thức thành POST, bạn sẽ cần truyền tham số thành phố trong tải trọng body và sẽ cần tạo một mô hình cho schema đối tượng này cho trình tạo mã để tạo một lớp Java để bạn sử dụng.\nThe result data from the API calls is returned in the body of the response. In order for the code generator to create an appropriate class to represent this response, we need to create a response model, and set it as the method response model. Dữ liệu kết quả từ các lệnh gọi API được trả về trong body của phản hồi. Để trình tạo mã có thể tạo một lớp thích hợp để đại diện cho phản hồi này, chúng ta cần tạo một mô hình phản hồi và đặt nó làm mô hình phản hồi phương thức.\n Truy cập API Gateway console và chọn Models là iDevelop - Trip Search API. Chọn Create Ở Model name nhập TripsFromCityResponse Ở Content-type nhập application/json Ở Model schema nhập vào mô tả bên dưới:  {\r\u0026#34;type\u0026#34; : \u0026#34;object\u0026#34;,\r\u0026#34;properties\u0026#34; : {\r\u0026#34;succeeded\u0026#34; : {\r\u0026#34;type\u0026#34; : \u0026#34;boolean\u0026#34;\r},\r\u0026#34;errorMessage\u0026#34; : {\r\u0026#34;type\u0026#34; : \u0026#34;string\u0026#34;\r},\r\u0026#34;errorType\u0026#34; : {\r\u0026#34;type\u0026#34; : \u0026#34;number\u0026#34;\r},\r\u0026#34;data\u0026#34; : {\r\u0026#34;type\u0026#34; : \u0026#34;array\u0026#34;,\r\u0026#34;items\u0026#34; : {\r\u0026#34;type\u0026#34; : \u0026#34;object\u0026#34;,\r\u0026#34;properties\u0026#34; : {\r\u0026#34;date\u0026#34;: {\r\u0026#34;type\u0026#34; : \u0026#34;number\u0026#34;\r},\r\u0026#34;originCity\u0026#34;: {\r\u0026#34;type\u0026#34; : \u0026#34;string\u0026#34;\r},\r\u0026#34;destinationCity\u0026#34;: {\r\u0026#34;type\u0026#34; : \u0026#34;string\u0026#34;\r},\r\u0026#34;airline\u0026#34;: {\r\u0026#34;type\u0026#34; : \u0026#34;string\u0026#34;\r}\r}\r}\r}\r},\r\u0026#34;title\u0026#34; : \u0026#34;TripsFromCityResponse\u0026#34;\r}\rChọn Create model  Gán TripsFromCityResponse model cho API /tripsfromcity Chọn Resources là iDevelop - Trip Search API. Chọn method GET ở /tripsfromcity/{city} Chọn Method Response Trong bảng /tripsfromcity/{city} - GET - Method Response chọn icon tam giác cạnh HTTP Status để xem panelpanel. Ở mục Response Body for 200 chọn biểu tượng bút chì kế bên Empty model. Trường sẽ trở thành một danh sách thả xuống. Lựa chọn TripsFromCityResponse và nhấp vào dấu tích màu xám để cam kết thay đổi. Từ menu Actions, chọn Deploy API Ở Deployment stage chọn prod from the list and click Deploy Trong mục prod Stage Editor xuất hiện, chọn SDK Generation Trong mục Platform chọn Java SDK Ở Service name nhập TripSearch Ở Java package name nhập idevelop.api.sdk  Chọn Generate SDK. Java SDK sẽ được tạo và tải xuống dưới dạng tệp ZIP. Giải nén tệp ZIP đã tải xuống trên môi trường làm việc của bạn Trong cửa số lệnh, cd vào vị trí giải nén mã nguồn và chạy lệnh sau:  mvn install\r# if you are using Eclipse IDE on Windows\r%M2_HOME%\\bin\\mvn install\rViệc này sẽ biên dịch và cài đặt SDK trong kho lưu trữ Maven cục bộ của bạn và chúng tôi sẽ đề cập đến nó trong các bước tiếp theo.\nTạo một ứng dụng client Java sử dụng API Tải xuống gói mã nguồn cho một ứng dụng thử nghiệm từ TripSearchJavaClient.zip và giải nén trong môi trường làm việc của bạn.\nNếu bạn đang sử dụng Cloud9, hãy tham khảo lệnh bên dưới:  cd ~/environment\rcurl -L https://workshops.devax.academy/monoliths-to-microservices/module6/files/TripSearchJavaClient.zip --output TripSearchJavaClient.zip\runzip TripSearchJavaClient.zip\r\r\r\rTripSearchJavaClient ource code bundle\r\r\rTripSearchJavaClient.zip\r\r(8 ko)\r\r\r\rIf you’re using Eclipse IDE, use the Open projects from filesystem location menu and browse to the filesystem location where you exploded the TripSearchJavaClient source code. Open the project.\nIf you’re using Cloud9, refer to the command below.  cd ~/environment/TripSearchJavaClient\rmvn install\r# if you are using Eclipse IDE on Windows\r%M2_HOME%\\bin\\mvn install\rRun the project. It will use the TripSearch API to call /tripsfromcity and search for trips with destination Melbourne. You will see an output like this:  Got 2 items in 91ms\rGot 2 items in 91ms\rGot 2 items in 90ms\r.\r.\r.\rGot 2 items in 90ms\rThe example API consumer will time how long each call to the API takes, and display the results. It will make a maximum of 100 calls as quickly as it can.\nIf we had many of these clients consuming the API rapidly, we could overwhelm the provisioned infrastructure, so we need some way of throttling calls. We can use Usage Plans to do this.\nOn the API Gateway console, click Usage Plans beneath the APIs navigator panel. Click Create to create a new Usage Plan For Name type LabPlan Under Throttling, for Rate type 1 For Burst type 1 Under Quota type 1000 per month  Click Next Click Add API Stage In the API drop-down list, select iDevelop - Trip Search API In the Stage drop-down list, select prod Click the grey tick icon to commit the changes Click Next Click Create API Key and add to Usage Plan In the dialog that appears, for Name type SDKClient Click Save Click Done. A new API key will be created and associated with the usage Plan. Click the iDevelop - Trip Search API link beneath APIs on the left of the API Gateway console. Click the GET method beneath /tripsfromcity/{city} Click Method Request Under Settings, for API Key Required, click the pencil edit icon, and choose true from the list.  Click the grey tick icon to commit the change From the Actions menu, select Deploy API Choose the prod stage and click Deploy to deploy the changes  Tái tạo client SDK và cài đặt trên máy development In the prod Stage Editor, click the SDK Generation tab For Platform, choose Java SDK For Service name type TripSearch For Java package name type idevelop.api.sdk  Click Generate SDK. The Java SDK will be generated and downloaded as a ZIP file. Explode the downloaded ZIP file on your filesystem. In a terminal window, cd into the folder where the downloaded SDK has been exploded (typically, the directory is called generated-code) and issue the following command:  mvn install\rThis will compile and install the SDK in your local Maven repository, overwriting the previous version. In the following steps, you will use this SDK artefact by referencing it in a client application POM file.\nKiểm thử SDK vừa tạo mới với Ứng dụng Client Java In the IDE, re-run the application without making any changes. Since you have set the /tripsfromcity/{GET} endpoint to require an API Key, but have not actually set an API in the client application, you will see a Forbidden error in the console.\nThiết lập API key trong mã nguồn Client và chạy lại Ứng dụng sử dụng API với tính năng throttling The provided client source code needs to be updated to set the API Key in order to successfully call the /tripsfromcity/{GET} method. On the AWS API Gateway Console, click the API Keys tab Click the SDKClient link Click the Show link next to API Key to reveal the auto-generated API key. Copy the value into your clipboard. In the IDE, in the /src/main/java/idevelop/api/tripsearch/sdk/app/App.java file, paste in the API Key in your clipboard, in the API_KEY definition, replacing the \u0026lt;REPLACE_WITH_API_KEY\u0026gt; placeholder. In the same file, locate the commented out call to apiKey(API_KEY) in the TripSearch builder call. You may have to run a Maven Update on the project to pick up the .apiKey as we updated the jar in the last step and Eclipse may not have picked it up. Now that you have required an API Key in the API Gateway call, the SDK created for you will contain a call to allow the key to be set. If you have no API Key requirements, the code generator does not emit this functionality so in the provided code, it is commented out. You need to enable the call in the client code to allow the API Key to be set correctly. Re-run the application in the IDE. Notice that the calls will now succeed, but, you will now periodically start receiving errors requesting you slow down the call-rate. This is because we set a maximum call-rate of 1 call per second per API key. You will see output like this:  Got 2 items in 97ms\rGot 2 items in 125ms\rToo Many Requests - waiting 1 second...\r.\r.\r.\rAs an experiment, edit the API_KEY you have set in the App class (for example, add a period at the end) which will cause it to be invalid. Re-run the app and notice that you now receive a Forbidden message. This is because you set the API Key as required for calls to the /tripsfromcity call. Experiment with the Rate and Burst settings in the Usage Plan to see how they affect the client app calling the API.  Note that you do not need to re-deploy the API nor re-create the SDK if you change the settings in the Usage Plan.\n\r"
},
{
	"uri": "/vi/6-conclusion/",
	"title": "Tổng kết",
	"tags": [],
	"description": "",
	"content": "Xin chúc mừng! Giờ đây, bạn đã triển khai thành công trang web TravelBuddy dưới dạng Ứng dụng web đơn trang được lưu trữ trên Amazon S3, với các serverless Lambda microservice được cung cấp thông qua Amazon API Gateway, cũng cung cấp tính năng điều tiết, quản lý hạn ngạch và chống DDoS. Bạn đã triển khai đăng nhập bảo mật qua Amazon Cognito và bảo vệ các lệnh gọi API bằng token cho mỗi lần gọi. Sau đó, bạn đã bật tính năng theo dõi bằng Amazon X-ray cho phép bạn hiểu rõ về ứng dụng của mình.\nTravelBuddy đã sẵn sàng lên thị trường!\n"
},
{
	"uri": "/vi/7-resources/",
	"title": "Tham khảo",
	"tags": [],
	"description": "",
	"content": "Những tài liệu tham khảo hữu ích:\n  AWS Cognito:\n https://aws.amazon.com/cognito/faqs/ https://docs.aws.amazon.com/cognito/latest/developerguide/iam-roles.html https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-identity.html https://aws.amazon.com/blogs/mobile/use-amazon-cognito-in-your-website-for-simple-aws-authentication/ https://forums.aws.amazon.com/forum.jspa?forumID=173    CORS explained:\n https://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html https://aws.amazon.com/blogs/aws/amazon-s3-cross-origin-resource-sharing/    API G/W:\n https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-mapping-template-reference.html    S3:\n https://aws.amazon.com/blogs/storage/protect-amazon-s3-buckets-using-access-analyzer-for-s3/ https://www.youtube.com/watch?v=rHeTn9pHNKo    Fielding\n https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm https://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf https://restfulapi.net/hateoas/ https://martinfowler.com/articles/richardsonMaturityModel.html    "
},
{
	"uri": "/vi/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/vi/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]